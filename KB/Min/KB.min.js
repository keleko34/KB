var CreateKB=function(){function v(){function e(){function a(a){if("outerHTML"===a.attr||"outerText"===a.attr)a.target=a.target.parentElement;var c=0,f=a.target,c=void 0!==a.arguments?a.arguments[0]:void 0,h="appendChild"===a.attr&&"INPUT"===passedtagName?c:[],l="appendChild"===a.attr&&"TEXTAREA"===c.tagName?c:[],e=f.getElementsByTagName("INPUT"),l=Array.prototype.slice.call(e).concat(h).filter(function(a){return"radio"!==a.type&&"checkbox"!==a.type}).concat(Array.prototype.slice.call(f.getElementsByTagName("TEXTAREA")).concat(l)),
h=Array.prototype.slice.call(e).concat(h).filter(function(a){return"radio"===a.type||"checkbox"===a.type}),f=d(f);"appendChild"===a.attr&&(a=c.nodeType,3!==a&&8!==a&&(f[f.length]=c));for(c=0;c<l.length;c++)void 0===l[c].kb_onkeydown&&l[c].kb_addInputBinding();for(c=0;c<h.length;c++)void 0===h[c].kb_onmousedown&&h[c].kb_addInputBoxBinding();b(f)}function d(a){var c=[];a=a.querySelectorAll("*");var b=a.length,d,e=0;for(d=0;d<b;d++)3!==a[d].nodeType&&8!==a[d].nodeType&&(c[e]=a[d],e++);return c}function b(a){for(var b=
a.length,d=w.length,h=0;h<b;h++)for(var l=0;l<d;l++)e.injectStyle(a[h],w[l],q,r)}var p=Object.keys(m);for(g=0;g<p.length;g++)void 0===m[p[g]].set&&e.injectPrototypes(m[p[g]].obj,q,r);e.addAttrUpdateListener("appendChild",a);e.addAttrUpdateListener("removeChild",a);e.addAttrUpdateListener("innerHTML",a);e.addAttrUpdateListener("outerHTML",a);e.addAttrUpdateListener("innerText",a);e.addAttrUpdateListener("outerText",a);e.addAttrUpdateListener("textContent",a);b(document.all);(function(){for(var a=0,
a=document.getElementsByTagName("INPUT"),b=Array.prototype.slice.call(a).filter(function(a){return"radio"!==a.type&&"checkbox"!==a.type}).concat(Array.prototype.slice.call(document.getElementsByTagName("TEXTAREA"))),d=Array.prototype.slice.call(a).filter(function(a){return"radio"===a.type||"checkbox"===a.type}),a=0;a<b.length;a++)void 0===b[a].kb_onkeydown&&b[a].kb_addInputBinding();for(a=0;a<d.length;a++)void 0===d[a].kb_onmousedown&&d[a].kb_addInputBoxBinding()})()}function v(a,d){e.addAttrListener.call(this,
a,d,!0)}function z(a,d){e.addAttrUpdateListener.call(this,a,d,!0)}var n={},t={},m={},w=Object.getOwnPropertyNames(document.all[0].style),g,u,x=function(a,d,b){var e=[],k=0;b=b?"kb_childAttrUpdateListeners":"kb_childAttrListeners";for(k=0;null!==a;)a=a.parentElement,null!==a&&void 0!==a[b]()[d]&&(e[k]=a,k++);return e},y=function(a,d,b,e,k,c,f){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};this.value=b;this.oldValue=e;this.target=a;
this.attr=d;this.arguments=k;this.action=c;this.child=void 0;this.type=f},q=function(a,d,b,e,k){b=new y(a,d,b,e,k,"set");e=void 0!==a.parentElement?x(a,d):[];k=e.length;var c=n["*"],f,h=n[d],l=void 0!==a.kb_attrListeners?a.kb_attrListeners()[d]:void 0;if(void 0!==c)a:for(f=c.length,g=0;g<f;g+=1)if(c[g].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==h&&void 0===b._stopPropogation)a:for(c=h.length,g=0;g<c;g+=1)if(h[g].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==l&&void 0===
b._stopPropogation)a:for(h=l.length,g=0;g<h;g+=1)if(l[g].call(a,b),void 0!==b._stopPropogation)break a;if(0<k&&void 0===b._stopPropogation)a:for(g=0;g<k;g++)if(l=e[g],h=l.kb_childAttrListeners()[d],void 0!==h)for(c=h.length,u=0;u<c;u++)if(b.child=a,b.target=l,h[u].call(l,b),void 0!==b._stopPropogation)break a;return void 0!==b._preventDefault?!1:!0},r=function(a,d,b,e,k,c){b=new y(a,d,b,e,k,c,"update");e=void 0!==a.parentElement?x(a,d,!0):[];k=e.length;var f=n["*"],h,l=n[d],g=void 0!==a.kb_attrUpdateListeners?
a.kb_attrUpdateListeners()[d]:void 0;if(void 0!==f)a:for(h=f.length,c=0;c<h;c+=1)if(f[c].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==l&&void 0===b._stopPropogation)a:for(f=l.length,c=0;c<f;c+=1)if(l[c].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==g&&void 0===b._stopPropogation)a:for(l=g.length,c=0;c<l;c+=1)if(g[c].call(a,b),void 0!==b._stopPropogation)break a;if(0<k&&void 0===b._stopPropogation)a:for(c=0;c<k;c++)if(g=e[c],l=g.kb_childAttrUpdateListeners()[d],void 0!==l)for(f=
l.length,u=0;u<f;u++)if(b.child=a,b.target=g,l[u].call(g,b),void 0!==b._stopPropogation)break a;return void 0!==b._preventDefault?!1:!0};e.injectPrototypeProperty=function(a,d,b,g,k){var c=a.prototype,f=Object.getOwnPropertyDescriptor(c,d);k=k||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");var h=m[k];void 0===c.addAttrListener&&void 0===c.kb_attrListeners&&(c.kb_attrListeners=function(){void 0===this._kb_attrListeners&&(this._kb_attrListeners={});return this._kb_attrListeners},c.addAttrListener=
e.addAttrListener,c.removeAttrListener=e.removeAttrListener);c.hasOwnProperty("children")&&void 0===c.addChildAttrListener&&void 0===c.kb_childAttrListeners&&(c.kb_childAttrListeners=function(){void 0===this._kb_childAttrListeners&&(this._kb_childAttrListeners={});return this._kb_childAttrListeners},c.addChildAttrListener=v,c.getchildAttrListeners=function(){return this.kb_childAttrListeners()});void 0===c.addAttrUpdateListener&&void 0===c.kb_attrUpdateListeners&&(c.kb_attrUpdateListeners=function(){void 0===
this._kb_attrUpdateListeners&&(this._kb_attrUpdateListeners={});return this._kb_attrUpdateListeners},c.addAttrUpdateListener=e.addAttrUpdateListener,c.removeAttrUpdateListener=e.removeAttrUpdateListener);c.hasOwnProperty("children")&&void 0===c.addChildAttrUpdateListener&&void 0===c.kb_childAttrUpdateListeners&&(c.kb_childAttrUpdateListeners=function(){void 0===this._kb_childAttrUpdateListeners&&(this._kb_childAttrUpdateListeners={});return this._kb_childAttrUpdateListeners},c.addChildAttrUpdateListener=
z,c.getchildAttrUpdateListeners=function(){return this.kb_childAttrUpdateListeners()});void 0===h&&(m[k]={obj:a,proto:c,descriptors:{},set:void 0,update:void 0},h=m[k]);h.set=b?b:m[k].set;h.update=g?g:m[k].update;h.descriptors[d]=f;void 0!==f.set&&f.configurable?Object.defineProperty(c,d,{get:f.get,set:function(a){var b=f.get.apply(this),c=h.set,e=h.update;"function"===typeof c&&c(this,d,a,b,arguments)&&f.set.apply(this,arguments);"function"===typeof e&&e(this,d,a,b,arguments)},enumerable:!0,configurable:!0}):
"function"===typeof f.value?Object.defineProperty(c,d,{value:function(){var a=null,b=h.set,c=h.update;"function"===typeof b&&b(this,d,null,null,arguments)&&(a=f.value.apply(this,arguments));"function"===typeof c&&c(this,d,null,null,arguments,a);return a},writable:!0,enumerable:!0,configurable:!0}):void 0!==f.value&&f.configurable&&Object.defineProperty(c,d,{get:function(){return f.value},set:function(a){var b=f.value,c=h.set,e=h.update;"function"===typeof c&&c(this,d,a,b)&&(f.value=a);"function"===
typeof e&&e(this,d,a,b)},enumerable:!0,configurable:!0})};e.injectPrototypes=function(a,d,b){var p=a.prototype,k=a.toString().split(/\s+/)[1].split("{")[0].replace("()",""),c=m[k],f=Object.getOwnPropertyNames(p),h={},l=function(a){var b=!1,d="false";if("checkbox"===this.type||"radio"===this.type)d=this.checked,b=!0;var e=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;setTimeout(function(){var a=c.set,f=c.update;b&&!a(this,"checked",this.checked,
d)?h.checked.set.call(this,d):b&&"function"===typeof f&&f(this,"checked",this.checked,e);this.value=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;a(this,"value",this.value,e)?"function"===typeof f&&f(this,"value",this.value,e):h.value.set.call(this,e)}.bind(this),0)};void 0===c&&(m[k]={obj:a,proto:p,descriptors:{},set:void 0,update:void 0},c=m[k]);c.set=d||q;c.update=b||r;-1<f.indexOf("value")&&(Object.defineProperty(p,"kb_removeInputBinding",
{value:function(){this.kb_onkeydown=void 0;this.removeEventListener("keydown",l)},configurable:!0,enumerable:!0}),Object.defineProperty(p,"kb_addInputBinding",{value:function(){this.kb_onkeydown=!0;this.addEventListener("keydown",l)},configurable:!0,enumerable:!0}),Object.defineProperty(p,"kb_removeInputBoxBinding",{value:function(){this.kb_onmousedown=void 0;this.removeEventListener("mouseup",l)},configurable:!0,enumerable:!0}),Object.defineProperty(p,"kb_addInputBoxBinding",{value:function(){this.kb_onmousedown=
!0;this.addEventListener("mouseup",l)},configurable:!0,enumerable:!0}));for(g=0;g<f.length;g+=1)void 0===m[k].descriptors[f[g]]&&e.injectPrototypeProperty(a,f[g],null,null,k);return e};e.injectStyle=function(a,d,b,g){var k=Object.getOwnPropertyDescriptor(a.style,d),c=a.style;void 0===a.style.kb_bind&&(a.style.kb_bind={obj:a,proto:c,descriptors:{},set:void 0,update:void 0});a.style.kb_bind.set=b?b:m[_injectName].set;a.style.kb_bind.update=g?g:m[_injectName].update;a.style.kb_bind.descriptors[d]=k;
void 0!==k.value&&k.configurable&&Object.defineProperty(c,d,{get:function(){return k.value},set:function(b){var c=k.value;"function"==typeof a.style.kb_bind.set&&a.style.kb_bind.set(a,d,b,c)&&(k.value=b,a.style.setProperty(d.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),b));"function"===typeof a.style.kb_bind.update&&a.style.kb_bind.update(a,d,b,c)},enumerable:!0,configurable:!0});return e};e.injectedPrototypes=function(){return m};e.addAttrListener=function(a,d,b){if(this.toString()!==e.toString())return void 0===
this.kb_attrListeners()[a]&&(this.kb_attrListeners()[a]=[]),b&&void 0===this.kb_childAttrListeners()[a]&&(this.kb_childAttrListeners()[a]=[]),"function"===typeof d&&(b?this.kb_childAttrListeners()[a].push(d):this.kb_attrListeners()[a].push(d)),this;void 0===n[a]&&(n[a]=[]);"function"===typeof d&&n[a].push(d);return e};e.addAttrUpdateListener=function(a,d,b){if(this.toString()!==e.toString())return void 0===this.kb_attrUpdateListeners()[a]&&(this.kb_attrUpdateListeners()[a]=[]),b&&void 0===this.kb_childAttrUpdateListeners()[a]&&
(this.kb_childAttrUpdateListeners()[a]=[]),"function"===typeof d&&(b?this.kb_childAttrUpdateListeners()[a].push(d):this.kb_attrUpdateListeners()[a].push(d)),this;void 0===t[a]&&(t[a]=[]);"function"===typeof d&&t[a].push(d);return e};e.getAttrListeners=function(){return this.toString()!==e.toString()?this.kb_attrListeners():n};e.getAttrUpdateListeners=function(){return this.toString()!==e.toString()?this.kb_attrUpdateListeners():t};e.removeAttrListener=function(a,d){if(this.toString()!==e.toString()){if(void 0!==
this.kb_attrListeners&&void 0!==this.kb_attrListeners()[a]&&"function"===typeof d){for(var b=0;b<this.kb_attrListeners()[a].length;b+=1)this.kb_attrListeners()[a][b].toString()===d.toString()&&this.kb_attrListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrListeners()[a])for(b=0;b<this.kb_childAttrListeners()[a].length;b+=1)this.kb_childAttrListeners()[a][b].toString()===d.toString()&&this.kb_childAttrListeners()[a].splice(b,1)}return this}if(void 0!==n[a]&&"function"===typeof d)for(b=0;b<n[a].length;b+=
1)n[a][b].toString()===d.toString()&&n[a].splice(b,1);return e};e.removeAttrUpdateListener=function(a,d){if(this.toString()!==e.toString()){if(void 0!==this.kb_attrUpdateListeners&&void 0!==this.kb_attrUpdateListeners()[a]&&"function"===typeof d){for(var b=0;b<this.kb_attrUpdateListeners()[a].length;b+=1)this.kb_attrUpdateListeners()[a][b].toString()===d.toString()&&this.kb_attrUpdateListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrUpdateListeners()[a])for(b=0;b<this.kb_childAttrUpdateListeners()[a].length;b+=
1)this.kb_childAttrUpdateListeners()[a][b].toString()===d.toString()&&this.kb_childAttrUpdateListeners()[a].splice(b,1)}return this}if(void 0!==t[a]&&"function"===typeof d)for(b=0;b<t[a].length;b+=1)t[a][b].toString()===d.toString()&&t[a].splice(b,1);return e};e.injectPrototypes(Node,q,r);e.injectPrototypes(Element,q,r);e.injectPrototypes(HTMLElement,q,r);e.injectPrototypes(HTMLInputElement,q,r);e.injectPrototypes(HTMLTextAreaElement,q,r);e.injectPrototypes(Document,q,r);return e}"function"===typeof define&&
define.amd?(define("KB",v),define([],function(){return v})):"object"===typeof module&&module.exports&&(module.exports=v);return v}();

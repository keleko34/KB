var KB=function(){var E=function(){function E(){function k(b,c){var a=b.length,d;for(d=0;d<a&&(b[d](c),void 0===c._stopPropogation);d++);}function r(b,c){var a=b.length,d;for(d=0;d<a&&(c.child=c.target,c.target=b[d].parent,b[d].func(c),void 0===c._stopPropogation);d++);}function J(b,c,a,d,f,e,g){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};this.value=a;this.oldValue=d;this.target=b;this.attr=c;this.arguments=f;this.action=e;this.child=
void 0;this.type=g}function K(){this._attrListeners={};this._attrUpdateListeners={};this._styleListeners={};this._styleUpdateListeners={};this._parentStyleListeners={};this._parentStyleUpdateListeners={};this._parentAttrListeners={};this._parentAttrUpdateListeners={};this._injectedStyle={}}function N(b,c,a,d){var f=b.get,e=b.set,g;return function(b){g=f.call(this);a(this,c,b,g)&&e.call(this,b);d(this,c,b,g)}}function O(b,c,a,d){var f;return function(e){f=b.value;a(this,c,e,f,arguments)&&(b.value=
e);d(this,c,e,f,arguments)}}function P(b,c,a,d){var f=b.value,e;return function(){a(this,c,null,null,arguments)&&(e=f.apply(this,arguments));d(this,c,null,null,arguments,e);return e}}function Q(b,c,a,d,f){var e=f.style,g=c.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),h,m;return{get:function(){return m},set:function(b){h=m;a(f,c,b,h)&&(m=b,e.setProperty(g,b));d(f,c,b,h)},enumerable:!0,configurable:!0}}function G(b,c,a,d){if("function"!==typeof c)return h;var f=-1!==["value","checked"].indexOf(b),
e=-1!==w.indexOf(b),g;if(this.toString()!==h.toString())if(a){var u=this.querySelectorAll("*");a=u.length;for(var m,l=0;l<a;l++){m=u[l].attrListeners();if(f||"*"===b)void 0!==u[l].addInputBinding&&u[l].addInputBinding(),void 0!==u[l].addInputBoxBinding&&u[l].addInputBoxBinding();if(e)h.injectStyleProperty(u[l],b),g=d?"_parentStyleUpdateListeners":"_parentStyleListeners";else{if("*"===b){g=d?"_parentStyleUpdateListeners":"_parentStyleListeners";a=w.length;for(var n=0;n<a;n++)h.injectStyleProperty(u[l],
w[n]);void 0===m[g]["*"]&&(m[g]["*"]=[]);m[g]["*"].push({parent:this,func:c})}g=d?"_parentAttrUpdateListeners":"_parentAttrListeners"}void 0===m[g][b]&&(m[g][b]=[]);m[g][b].push({parent:this,func:c})}}else{m=this.attrListeners();if(e)g=d?"_styleUpdateListeners":"_styleListeners",h.injectStyleProperty(this,b);else{if(f||"*"===b)void 0!==this.addInputBinding&&this.addInputBinding(),void 0!==this.addInputBoxBinding&&this.addInputBoxBinding();if("*"===b){g=d?"_styleUpdateListeners":"_styleListeners";
a=w.length;for(l=0;l<a;l++)h.injectStyleProperty(this,w[l]);void 0===m[g][b]&&(m[g][b]=[]);m[g][b].push(c)}g=d?"_attrUpdateListeners":"_attrListeners"}void 0===m[g][b]&&(m[g][b]=[]);m[g][b].push(c)}else{if(f||"*"===b)for(n=document.querySelectorAll("input, textarea"),a=n.length,l=0;l<a;l++)void 0!==n[l].addInputBinding&&n[l].addInputBinding(),void 0!==n[l].addInputBoxBinding&&n[l].addInputBoxBinding();if(e){e=Array.prototype.slice.call(document.body.querySelectorAll("*"));a=e.length+1;e.unshift(document.body);
for(l=0;l<a;l++)h.injectStyleProperty(e[l],b);g=d?z:A}else{if("*"===b){e=Array.prototype.slice.call(document.body.querySelectorAll("*"));a=e.length+1;f=w.length;e.unshift(document.body);for(l=0;l<a;l++)for(n=0;n<f;n++)h.injectStyleProperty(e[l],w[n]);g=d?z:A;void 0===g[b]&&(g[b]=[]);g[b].push(c)}g=d?B:C}void 0===g[b]&&(g[b]=[]);g[b].push(c)}}function H(b,c,a,d){function f(b,a){var e=a[b],d=e.length;for(g=0;g<d;g++)e[g].toString()===c.toString()&&e.splice(g,1)}if("function"!==typeof c)return h;["value",
"checked"].indexOf(b);var e=-1!==w.indexOf(b),g;if(this.toString()!==h.toString())if(a){a=this.querySelectorAll("*");var u=a.length;e?(e=d?"_childStyleUpdateListeners":"_childStyleListeners",f(b,this.attrListeners()[e]),e=d?"_parentStyleUpdateListeners":"_parentStyleListeners"):("*"===b&&(e=d?"_childStyleUpdateListeners":"_childStyleListeners",f(b,this.attrListeners()[e])),e=d?"_childAttrUpdateListeners":"_childAttrListeners",f(b,this.attrListeners()[e]),e=d?"_parentAttrUpdateListeners":"_parentAttrListeners");
for(g=0;g<u;g++){for(var m=a[g].attrListeners()[e][b],l=m.length,n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1);if("*"===b)for(listenersStyle=d?"_parentStyleUpdateListeners":"_parentStyleListeners",m=a[g].attrListeners()[e][b],l=m.length,n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1)}}else e?e=d?"_styleUpdateListeners":"_styleListeners":("*"===b&&(e=d?"_styleUpdateListeners":"_styleListeners",f(b,this.attrListeners()[e])),e=d?"_attrUpdateListeners":"_attrListeners"),f(b,this.attrListeners()[e]);
else e?e=d?z:A:("*"===b&&(e=d?z:A,f(b,e)),e=d?B:C),f(b,e)}function L(b,c){h.addAttrListener.call(this,b,c,!0);return this}function M(b,c){h.addAttrUpdateListener.call(this,b,c,!0);return this}function R(b,c){h.removeAttrListener.call(this,b,c,!0);return this}function S(b,c){h.removeAttrUpdateListener.call(this,b,c,!0);return this}function h(){function b(b,a){var c,e=a.length;for(c=0;c<e;c++)-1===b.indexOf(a[c])&&b.push(a[c]);return b}function c(a){if(3!==a.target.nodeType&&8!==a.target.nodeType){var c=
a.target.attrListeners(),e,d=["value","checked"],f=c._attrListeners,x=c._attrUpdateListeners,p=c._parentAttrListeners;e=c._parentAttrUpdateListeners;var k=!1;if(void 0!==C["*"]||void 0!==B["*"])k=!0;if(!0!==k&&void 0!==f["*"]||void 0!==x["*"]||void 0!==p["*"]||void 0!==e["*"])k=!0;if(!0!==k)for(var v=0;v<d.length;v++)if(void 0!==C[d[v]]||void 0!==B[d[v]]||void 0!==f[d[v]]||void 0!==x[d[v]]||void 0!==p[d[v]]||void 0!==e[d[v]]){k=!0;break}e=k;d=Object.keys(A);f=Object.keys(z);Object.keys(c._styleListeners);
Object.keys(c._styleUpdateListeners);x=Object.keys(c._parentStyleListeners);c=Object.keys(c._parentStyleUpdateListeners);p=[];if(0!==d.length||0!==f.length)p=b(p,d),p=b(p,f);if(0!==p.length&&0!==x.length||0!==c.length)p=b(p,x),p=b(p,c);-1!==p.indexOf("*")&&(p=w);var c=p,d=c.length,r,y,f=[],q,x="outerHTML"===a.attr||"outerText"===a.attr?a.attr:void 0,p=a.target;void 0!==x&&(a.attr="appendChild",a.arguments=[a.target],a.target=a.target.parentElement);if(e){"appendChild"===a.attr&&3!==a.arguments[0].nodeType&&
8!==a.arguments[0].nodeType?(f=Array.prototype.slice.call(a.arguments[0].querySelectorAll("input,textarea")),"INPUT"!==a.arguments[0].tagName&&"TEXTAREA"!==a.arguments[0].tagName||f.unshift(a.arguments[0])):f=Array.prototype.slice.call(a.target.querySelectorAll("input,textarea"));q=f.length;for(var t=0;t<q;t++)void 0!==f[t].addInputBinding&&f[t].addInputBinding(),void 0!==f[t].addInputBoxBinding&&f[t].addInputBoxBinding()}"appendChild"===a.attr&&"#text"!==a.arguments[0].nodeName&&"#comment"!==a.arguments[0].nodeName?
(f=Array.prototype.slice.call(a.arguments[0].querySelectorAll("*")),f.unshift(a.arguments[0])):f=Array.prototype.slice.call(a.target.querySelectorAll("*"));e=a.target.__kb._parentAttrListeners;k=a.target.__kb._parentAttrUpdateListeners;v=a.target.__kb._parentStyleListeners;r=a.target.__kb._parentStyleUpdateListeners;q=f.length;for(t=0;t<q;t++){if(0!==d)for(y=0;y<d;y++)h.injectStyleProperty(f[t],c[y]);y=f[t].attrListeners();y._parentAttrListeners=e;y._parentAttrUpdateListeners=k;y._parentStyleListeners=
v;y._parentStyleUpdateListeners=r}void 0!==x&&(a.attr=x,a.target=p,a.arguments=[])}}function a(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";f(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])||a.preventDefault()}function d(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";e(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])}h.injectPrototypes(Node,"Node");h.injectPrototypes(Element,"Element");h.injectPrototypes(HTMLElement,
"HTMLElement");h.injectPrototypes(HTMLInputElement,"HTMLInputElement");h.injectPrototypes(HTMLTextAreaElement,"HTMLTextAreaElement");h.injectPrototypes(Document,"Document");var f=I,e=F;h.addAttrUpdateListener("appendChild",c);h.addAttrUpdateListener("removeChild",c);h.addAttrUpdateListener("innerHTML",c);h.addAttrUpdateListener("outerHTML",c);h.addAttrUpdateListener("innerText",c);h.addAttrUpdateListener("outerText",c);h.addAttrUpdateListener("textContent",c);h.addAttrListener("setAttribute",a);h.addAttrListener("removeAttribute",
a);h.addAttrUpdateListener("setAttribute",d);h.addAttrUpdateListener("removeAttribute",d);return h}var C={},B={},A={},z={},q={},D="textContent innerHTML innerText outerHTML outerText appendChild removeChild replaceChild insertAdjacentHTML insertBefore".split(" "),w=Object.getOwnPropertyNames(document.body.style),I=function(b,c,a,d,f){a=new J(b,c,a,d,f,void 0,"set");if(void 0!==b.__kb){d=b.__kb._attrListeners;f=b.__kb._styleListeners;var e=b.__kb._parentAttrListeners;b=b.__kb._parentStyleListeners;
void 0!==d[c]&&k(d[c],a);void 0===a._stopPropogation&&void 0!==f[c]&&k(f[c],a);void 0===a._stopPropogation&&void 0!==d["*"]&&(k(d["*"],a),void 0===a._stopPropogation&&k(f["*"],a));void 0===a._stopPropogation&&void 0!==e[c]&&r(e[c],a);void 0===a._stopPropogation&&void 0!==b[c]&&r(b[c],a);void 0===a._stopPropogation&&void 0!==e["*"]&&(r(e["*"],a),void 0===a._stopPropogation&&r(b["*"],a))}void 0===a._stopPropogation&&void 0!==C[c]&&k(C[c],a);void 0===a._stopPropogation&&void 0!==A[c]&&k(A[c],a);void 0===
a._stopPropogation&&void 0!==C["*"]&&(k(C["*"],a),void 0===a._stopPropogation&&k(A["*"],a));return void 0!==a._preventDefault?!1:!0},F=function(b,c,a,d,f,e){a=new J(b,c,a,d,f,e,"update");void 0!==b.__kb&&(d=b.__kb._attrUpdateListeners,f=b.__kb._styleUpdateListeners,e=b.__kb._parentAttrUpdateListeners,b=b.__kb._parentStyleUpdateListeners,void 0!==d[c]&&k(d[c],a),void 0===a._stopPropogation&&void 0!==f[c]&&k(f[c],a),void 0===a._stopPropogation&&void 0!==d["*"]&&(k(d["*"],a),void 0===a._stopPropogation&&
k(f["*"],a)),void 0===a._stopPropogation&&void 0!==e[c]&&r(e[c],a),void 0===a._stopPropogation&&void 0!==b[c]&&r(b[c],a),void 0===a._stopPropogation&&void 0!==e["*"]&&(r(e["*"],a),void 0===a._stopPropogation&&r(b["*"],a)));void 0===a._stopPropogation&&void 0!==B[c]&&k(B[c],a);void 0===a._stopPropogation&&void 0!==z[c]&&k(z[c],a);void 0===a._stopPropogation&&void 0!==B["*"]&&(k(B["*"],a),void 0===a._stopPropogation&&k(z["*"],a));return void 0!==a._preventDefault?!1:!0};h.injectPrototypeProperty=function(b,
c,a,d,f){var e=b.prototype,g=Object.getOwnPropertyDescriptor(e,c);a=a||b.toString().split(/\s+/)[1].split("{")[0].replace("()","");var k=q[a];d=d||I;f=f||F;void 0===e.attrListeners&&(e={},e.attrListeners=function(){void 0===this.__kb&&(this.__kb=new K);return this.__kb}.bind(e),e.addAttrListener=h.addAttrListener,e.addAttrUpdateListener=h.addAttrUpdateListener,e.addChildAttrListener=L,e.addChildAttrUpdateListener=M,e.removeAttrListener=h.removeAttrListener,e.removeAttrUpdateListener=h.removeAttrUpdateListener,
e.removeChildAttrListener=R,e.removeChildAttrUpdateListener=S);void 0===k&&(q[a]={obj:b,proto:e,descriptors:{},set:void 0,update:void 0},k=q[a],k.set=d,k.update=f);void 0===k.descriptors[c]&&(k.descriptors[c]=g);g.configurable&&(void 0!==g.set?Object.defineProperty(e,c,{get:g.get,set:N(g,c,d,f),enumerable:!0,configurable:!0}):"function"===typeof g.value?Object.defineProperty(e,c,{value:P(g,c,d,f),writable:!0,enumerable:!0,configurable:!0}):void 0!==g.value&&Object.defineProperty(e,c,{get:function(){return g.value},
set:O(g,c,d,f),enumerable:!0,configurable:!0}));return h};h.injectStyleProperty=function(b,c,a,d){var f=b.style,e=Object.getOwnPropertyDescriptor(f,c),g=b.attrListeners().injectedStyle;a=a||I;d=d||F;void 0===g&&(b.attrListeners().injectedStyle={obj:b,proto:f,descriptors:{},set:void 0,update:void 0},b.attrListeners().injectedStyle.set=a,b.attrListeners().injectedStyle.update=d,g=b.attrListeners().injectedStyle);void 0===g.descriptors[c]&&(g.descriptors[c]=e);e.configurable&&Object.defineProperty(f,
c,Q(e,c,a,d,b));return h};h.injectPrototypes=function(b,c,a,d){var f=b.prototype;c=c||b.toString().split(/\s+/)[1].split("{")[0].replace("()","");var e=q[c],g=Object.getOwnPropertyNames(f);a=a||I;d=d||F;var k;void 0===f.attrListeners&&(f.attrListeners=function(){void 0===this.__kb&&(this.__kb=new K);return this.__kb},f.addAttrListener=h.addAttrListener,f.addAttrUpdateListener=h.addAttrUpdateListener,f.addChildAttrListener=L,f.addChildAttrUpdateListener=M);void 0===e&&(q[c]={obj:b,proto:f,descriptors:{},
set:void 0,update:void 0},e=q[c],e.set=a,e.update=d);k=q[c].descriptors;for(d=0;d<g.length;d+=1)void 0===k[g[d]]&&h.injectPrototypeProperty(b,g[d],c,a,F);if(-1!==g.indexOf("value")){var m=function(a){var b,c,d;if("checkbox"===this.type||"radio"===this.type)b=!0;c=b?"string"===typeof this.checked?this.checked:this.checked?"true":"false":this.value;setTimeout(function(){d=b?"string"===typeof this.checked?this.checked:this.checked?"true":"false":this.value;b&&(e.set(this,"checked",this.checked,c)?e.update(this,
"checked",this.checked,c):k.checked.set.call(this,c));this.value=d;e.set(this,"value",this.value,c)?e.update(this,"value",this.checked,c):k.value.set.call(this,c)}.bind(this),0)};f.removeInputBinding=function(){this.attrListeners()._onkeydown=void 0;this.removeEventListener("keydown",m)};f.addInputBinding=function(){this.attrListeners()._onkeydown=!0;this.addEventListener("keydown",m)};f.removeInputBoxBinding=function(){this.attrListeners()._onmousedown=void 0;this.removeEventListener("mouseup",m)};
f.addInputBoxBinding=function(){this.attrListeners()._onmousedown=!0;this.addEventListener("mouseup",m)}}return h};h.addAttrListener=function(b,c,a){if("html"===b){b=0;for(var d=D.length;b<d;b++)G.call(this,D[b],c,a,!1)}else G.call(this,b,c,a,!1);return h};h.addAttrUpdateListener=function(b,c,a){if("html"===b){b=0;for(var d=D.length;b<d;b++)G.call(this,D[b],c,a,!0)}else G.call(this,b,c,a,!0);return h};h.removeAttrListener=function(b,c,a){if("html"===b){b=0;for(var d=D.length;b<d;b++)H.call(this,D[b],
c,a,!1)}else H.call(this,b,c,a,!1);return h};h.removeAttrUpdateListener=function(b,c,a){if("html"===b){b=0;for(var d=D.length;b<d;b++)H.call(this,D[b],c,a,!0)}else H.call(this,b,c,a,!0);return h};h.injectedPrototypes=function(){return q};return h}"function"===typeof define&&define.amd&&define("KB",E);return E}();window.define&&window.require?define([],function(){return E}):window.module&&(module.exports=E);return E}();

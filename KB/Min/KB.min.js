var KB=function(){var G=function(){function G(){function k(a,c){var b=a.length,d;for(d=0;d<b&&(a[d](c),void 0===c._stopPropogation);d++);}function p(a,c){var b=a.length,d;for(d=0;d<b&&(c.child=c.target,c.target=a[d].parent,a[d].func(c),void 0===c._stopPropogation);d++);}function I(a,c){for(var b=a.length;0<b;K++)if(a[K].toString()===c.toString())return!0;return!1}function L(a,c,b,d,f,e,g,r){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=
!0};this.value=b;this.oldValue=d;this.target=a;this.attr=c;this.arguments=f;this.action=e;this.child=void 0;this.type=g;this.stopChange=r}function M(){this._attrListeners={};this._attrUpdateListeners={};this._styleListeners={};this._styleUpdateListeners={};this._parentStyleListeners={};this._parentStyleUpdateListeners={};this._parentAttrListeners={};this._parentAttrUpdateListeners={};this._injectedStyle={}}function R(a,c,b,d){var f=a.get,e=a.set,g;return function(a){g=f.call(this);b(this,c,a,g,void 0,
this._stopChange)&&e.call(this,a);this._stopChange||d(this,c,a,g);this._stopChange=void 0}}function S(a,c,b,d){var f;return function(e){f=a.value;b(this,c,e,f,arguments,this._stopChange)&&(a.value=e);this._stopChange||d(this,c,e,f,arguments);this._stopChange=void 0}}function T(a,c,b,d){var f=a.value,e;return function(){b(this,c,null,null,arguments,this._stopChange)&&(e=f.apply(this,arguments));this._stopChange||d(this,c,null,null,arguments,e);this._stopChange=void 0;return e}}function U(a,c,b,d,f){var e=
f.style,g=c.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),r,m;return{get:function(){return m},set:function(a){r=m;b(f,c,a,r,void 0,this._stopChange)&&(m=a,e.setProperty(g,a));this._stopChange||d(f,c,a,r);this._stopChange=void 0},enumerable:!0,configurable:!0}}function E(a,c,b,d){if("function"!==typeof c)return h;var f=-1!==["value","checked"].indexOf(a),e=-1!==x.indexOf(a),g;if(this.toString()!==h.toString())if(b){var r=this.querySelectorAll("*");b=r.length;for(var m,l=0;l<b;l++){m=r[l].attrListeners();
if(f||"*"===a)void 0!==r[l].addInputBinding&&r[l].addInputBinding(),void 0!==r[l].addInputBoxBinding&&r[l].addInputBoxBinding();if(e)h.injectStyleProperty(r[l],a),g=d?"_parentStyleUpdateListeners":"_parentStyleListeners";else{if("*"===a){g=d?"_parentStyleUpdateListeners":"_parentStyleListeners";b=x.length;for(var n=0;n<b;n++)h.injectStyleProperty(r[l],x[n]);void 0===m[g]["*"]&&(m[g]["*"]=[]);m[g]["*"].push({parent:this,func:c})}g=d?"_parentAttrUpdateListeners":"_parentAttrListeners"}void 0===m[g][a]&&
(m[g][a]=[]);m[g][a].push({parent:this,func:c})}}else{m=this.attrListeners();if(e)g=d?"_styleUpdateListeners":"_styleListeners",h.injectStyleProperty(this,a);else{if(f||"*"===a)void 0!==this.addInputBinding&&this.addInputBinding(),void 0!==this.addInputBoxBinding&&this.addInputBoxBinding();if("*"===a){g=d?"_styleUpdateListeners":"_styleListeners";b=x.length;for(l=0;l<b;l++)h.injectStyleProperty(this,x[l]);void 0===m[g][a]&&(m[g][a]=[]);m[g][a].push(c)}g=d?"_attrUpdateListeners":"_attrListeners"}void 0===
m[g][a]&&(m[g][a]=[]);m[g][a].push(c)}else{if(f||"*"===a)for(n=document.querySelectorAll("input, textarea"),b=n.length,l=0;l<b;l++)void 0!==n[l].addInputBinding&&n[l].addInputBinding(),void 0!==n[l].addInputBoxBinding&&n[l].addInputBoxBinding();if(e){e=Array.prototype.slice.call(document.body.querySelectorAll("*"));b=e.length+1;e.unshift(document.body);for(l=0;l<b;l++)h.injectStyleProperty(e[l],a);g=d?B:C}else{if("*"===a){e=Array.prototype.slice.call(document.body.querySelectorAll("*"));b=e.length+
1;f=x.length;e.unshift(document.body);for(l=0;l<b;l++)for(n=0;n<f;n++)h.injectStyleProperty(e[l],x[n]);g=d?B:C;void 0===g[a]&&(g[a]=[]);g[a].push(c)}g=d?y:z}void 0===g[a]&&(g[a]=[]);g[a].push(c)}}function F(a,c,b,d){function f(a,b){var d=b[a],e=d.length;for(g=0;g<e;g++)d[g].toString()===c.toString()&&d.splice(g,1)}if("function"!==typeof c)return h;["value","checked"].indexOf(a);var e=-1!==x.indexOf(a),g;if(this.toString()!==h.toString())if(b){b=this.querySelectorAll("*");var r=b.length;e?(e=d?"_childStyleUpdateListeners":
"_childStyleListeners",f(a,this.attrListeners()[e]),e=d?"_parentStyleUpdateListeners":"_parentStyleListeners"):("*"===a&&(e=d?"_childStyleUpdateListeners":"_childStyleListeners",f(a,this.attrListeners()[e])),e=d?"_childAttrUpdateListeners":"_childAttrListeners",f(a,this.attrListeners()[e]),e=d?"_parentAttrUpdateListeners":"_parentAttrListeners");for(g=0;g<r;g++){for(var m=b[g].attrListeners()[e][a],l=m.length,n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1);if("*"===a)for(listenersStyle=d?"_parentStyleUpdateListeners":
"_parentStyleListeners",m=b[g].attrListeners()[e][a],l=m.length,n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1)}}else e?e=d?"_styleUpdateListeners":"_styleListeners":("*"===a&&(e=d?"_styleUpdateListeners":"_styleListeners",f(a,this.attrListeners()[e])),e=d?"_attrUpdateListeners":"_attrListeners"),f(a,this.attrListeners()[e]);else e?e=d?B:C:("*"===a&&(e=d?B:C,f(a,e)),e=d?y:z),f(a,e)}function N(a,c){h.addAttrListener.call(this,a,c,!0);return this}function O(a,c){h.addAttrUpdateListener.call(this,a,
c,!0);return this}function V(a,c){h.removeAttrListener.call(this,a,c,!0);return this}function W(a,c){h.removeAttrUpdateListener.call(this,a,c,!0);return this}function P(a,c,b){var d=this.attrListeners();"html"===c&&(c="innerHTML");"events"===c&&(c="onclick");switch(a){case "attr":if(I(d._attrListeners[c],b))return!0;break;case "attrupdate":if(I(d._attrUpdateListeners[c],b))return!0}return!1}function Q(){this._stopChange=!0;return this}function h(){function a(a,b){var c,d=b.length;for(c=0;c<d;c++)-1===
a.indexOf(b[c])&&a.push(b[c]);return a}function c(a,b){for(var c=Object.keys(a),d,e,g=0,f=c.length;g<f;g++)if(d=c[g],void 0===b[d])b[d]=a[d].slice();else for(var h=0,k=a[d].length;h<k;h++)e=a[d][h],b[d].push(e)}function b(b){if(3!==b.target.nodeType&&8!==b.target.nodeType){var d=b.target.attrListeners(),e,g=["value","checked"],f=d._attrListeners,k=d._attrUpdateListeners,q=d._parentAttrListeners;e=d._parentAttrUpdateListeners;var p=!1;if(void 0!==z["*"]||void 0!==y["*"])p=!0;if(!0!==p&&void 0!==f["*"]||
void 0!==k["*"]||void 0!==q["*"]||void 0!==e["*"])p=!0;if(!0!==p)for(var w=0;w<g.length;w++)if(void 0!==z[g[w]]||void 0!==y[g[w]]||void 0!==f[g[w]]||void 0!==k[g[w]]||void 0!==q[g[w]]||void 0!==e[g[w]]){p=!0;break}e=p;g=Object.keys(C);f=Object.keys(B);Object.keys(d._styleListeners);Object.keys(d._styleUpdateListeners);k=Object.keys(d._parentStyleListeners);d=Object.keys(d._parentStyleUpdateListeners);q=[];if(0!==g.length||0!==f.length)q=a(q,g),q=a(q,f);if(0!==q.length&&0!==k.length||0!==d.length)q=
a(q,k),q=a(q,d);-1!==q.indexOf("*")&&(q=x);var d=q,g=d.length,v,A,f=[],t,k="outerHTML"===b.attr||"outerText"===b.attr?b.attr:void 0,q=b.target;void 0!==k&&(b.attr="appendChild",b.arguments=[b.target],b.target=b.target.parentElement);if(e){"appendChild"===b.attr&&3!==b.arguments[0].nodeType&&8!==b.arguments[0].nodeType?(f=Array.prototype.slice.call(b.arguments[0].querySelectorAll("input,textarea")),"INPUT"!==b.arguments[0].tagName&&"TEXTAREA"!==b.arguments[0].tagName||f.unshift(b.arguments[0])):f=
Array.prototype.slice.call(b.target.querySelectorAll("input,textarea"));t=f.length;for(var u=0;u<t;u++)void 0!==f[u].addInputBinding&&f[u].addInputBinding(),void 0!==f[u].addInputBoxBinding&&f[u].addInputBoxBinding()}"appendChild"===b.attr&&"#text"!==b.arguments[0].nodeName&&"#comment"!==b.arguments[0].nodeName?(f=Array.prototype.slice.call(b.arguments[0].querySelectorAll("*")),f.unshift(b.arguments[0])):f=Array.prototype.slice.call(b.target.querySelectorAll("*"));e=b.target.__kb._parentAttrListeners;
p=b.target.__kb._parentAttrUpdateListeners;w=b.target.__kb._parentStyleListeners;v=b.target.__kb._parentStyleUpdateListeners;t=f.length;for(u=0;u<t;u++){if(0!==g)for(A=0;A<g;A++)h.injectStyleProperty(f[u],d[A]);A=f[u].attrListeners();c(e,A._parentAttrListeners);c(p,A._parentAttrUpdateListeners);c(w,A._parentStyleListeners);c(v,A._parentStyleUpdateListeners)}void 0!==k&&(b.attr=k,b.target=q,b.arguments=[])}}function d(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:
"";e(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])||a.preventDefault()}function f(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";g(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])}h.injectPrototypes(Node,"Node");h.injectPrototypes(Element,"Element");h.injectPrototypes(HTMLElement,"HTMLElement");h.injectPrototypes(HTMLInputElement,"HTMLInputElement");h.injectPrototypes(HTMLTextAreaElement,"HTMLTextAreaElement");h.injectPrototypes(Document,"Document");
var e=J,g=H;h.addAttrUpdateListener("appendChild",b);h.addAttrUpdateListener("removeChild",b);h.addAttrUpdateListener("innerHTML",b);h.addAttrUpdateListener("outerHTML",b);h.addAttrUpdateListener("innerText",b);h.addAttrUpdateListener("outerText",b);h.addAttrUpdateListener("textContent",b);h.addAttrListener("setAttribute",d);h.addAttrListener("removeAttribute",d);h.addAttrUpdateListener("setAttribute",f);h.addAttrUpdateListener("removeAttribute",f);return h}var z={},y={},C={},B={},v={},t="textContent innerHTML innerText outerHTML outerText appendChild removeChild replaceChild insertAdjacentHTML insertBefore".split(" "),
x=Object.getOwnPropertyNames(document.body.style),D=Object.keys(HTMLElement.prototype).filter(function(a){return 0===a.indexOf("on")}).concat(["addEventListener","removeEventListener"]),K,J=function(a,c,b,d,f,e){b=new L(a,c,b,d,f,void 0,"set",e);void 0!==a.__kb&&(d=a.__kb._attrListeners,f=a.__kb._styleListeners,e=a.__kb._parentAttrListeners,a=a.__kb._parentStyleListeners,void 0!==d[c]&&k(d[c],b),void 0===b._stopPropogation&&void 0!==f[c]&&k(f[c],b),void 0===b._stopPropogation&&void 0!==d["*"]&&(k(d["*"],
b),void 0===b._stopPropogation&&k(f["*"],b)),void 0===b._stopPropogation&&void 0!==e[c]&&p(e[c],b),void 0===b._stopPropogation&&void 0!==a[c]&&p(a[c],b),void 0===b._stopPropogation&&void 0!==e["*"]&&(p(e["*"],b),void 0===b._stopPropogation&&p(a["*"],b)));void 0===b._stopPropogation&&void 0!==z[c]&&k(z[c],b);void 0===b._stopPropogation&&void 0!==C[c]&&k(C[c],b);void 0===b._stopPropogation&&void 0!==z["*"]&&(k(z["*"],b),void 0===b._stopPropogation&&k(C["*"],b));return void 0!==b._preventDefault?!1:
!0},H=function(a,c,b,d,f,e){b=new L(a,c,b,d,f,e,"update");void 0!==a.__kb&&(d=a.__kb._attrUpdateListeners,f=a.__kb._styleUpdateListeners,e=a.__kb._parentAttrUpdateListeners,a=a.__kb._parentStyleUpdateListeners,void 0!==d[c]&&k(d[c],b),void 0===b._stopPropogation&&void 0!==f[c]&&k(f[c],b),void 0===b._stopPropogation&&void 0!==d["*"]&&(k(d["*"],b),void 0===b._stopPropogation&&k(f["*"],b)),void 0===b._stopPropogation&&void 0!==e[c]&&p(e[c],b),void 0===b._stopPropogation&&void 0!==a[c]&&p(a[c],b),void 0===
b._stopPropogation&&void 0!==e["*"]&&(p(e["*"],b),void 0===b._stopPropogation&&p(a["*"],b)));void 0===b._stopPropogation&&void 0!==y[c]&&k(y[c],b);void 0===b._stopPropogation&&void 0!==B[c]&&k(B[c],b);void 0===b._stopPropogation&&void 0!==y["*"]&&(k(y["*"],b),void 0===b._stopPropogation&&k(B["*"],b));return void 0!==b._preventDefault?!1:!0};h.injectPrototypeProperty=function(a,c,b,d,f){var e=a.prototype,g=Object.getOwnPropertyDescriptor(e,c);b=b||a.toString().split(/\s+/)[1].split("{")[0].replace("()",
"");var k=v[b];d=d||J;f=f||H;void 0===e.attrListeners&&(e={},e.attrListeners=function(){void 0===this.__kb&&(this.__kb=new M);return this.__kb}.bind(e),e.addAttrListener=h.addAttrListener,e.addAttrUpdateListener=h.addAttrUpdateListener,e.addChildAttrListener=N,e.addChildAttrUpdateListener=O,e.hasListener=P,e.removeAttrListener=h.removeAttrListener,e.removeAttrUpdateListener=h.removeAttrUpdateListener,e.removeChildAttrListener=V,e.removeChildAttrUpdateListener=W,e.stopChange=Q);void 0===k&&(v[b]={obj:a,
proto:e,descriptors:{},set:void 0,update:void 0},k=v[b],k.set=d,k.update=f);void 0===k.descriptors[c]&&(k.descriptors[c]=g);g.configurable&&(void 0!==g.set?Object.defineProperty(e,c,{get:g.get,set:R(g,c,d,f),enumerable:!0,configurable:!0}):"function"===typeof g.value?Object.defineProperty(e,c,{value:T(g,c,d,f),writable:!0,enumerable:!0,configurable:!0}):void 0!==g.value&&Object.defineProperty(e,c,{get:function(){return g.value},set:S(g,c,d,f),enumerable:!0,configurable:!0}));return h};h.injectStyleProperty=
function(a,c,b,d){var f=a.style,e=Object.getOwnPropertyDescriptor(f,c),g=a.attrListeners().injectedStyle;b=b||J;d=d||H;void 0===g&&(a.attrListeners().injectedStyle={obj:a,proto:f,descriptors:{},set:void 0,update:void 0},a.attrListeners().injectedStyle.set=b,a.attrListeners().injectedStyle.update=d,g=a.attrListeners().injectedStyle);void 0===g.descriptors[c]&&(g.descriptors[c]=e);e.configurable&&Object.defineProperty(f,c,U(e,c,b,d,a));return h};h.injectPrototypes=function(a,c,b,d){var f=a.prototype;
c=c||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");var e=v[c],g=Object.getOwnPropertyNames(f);b=b||J;d=d||H;var k;void 0===f.attrListeners&&(f.attrListeners=function(){void 0===this.__kb&&(this.__kb=new M);return this.__kb},f.addAttrListener=h.addAttrListener,f.addAttrUpdateListener=h.addAttrUpdateListener,f.addChildAttrListener=N,f.addChildAttrUpdateListener=O,f.hasListener=P,f.stopChange=Q);void 0===e&&(v[c]={obj:a,proto:f,descriptors:{},set:void 0,update:void 0},e=v[c],e.set=b,e.update=
d);k=v[c].descriptors;for(d=0;d<g.length;d+=1)void 0===k[g[d]]&&h.injectPrototypeProperty(a,g[d],c,b,H);if(-1!==g.indexOf("value")){var m=function(a){var b,c,d;if("checkbox"===this.type||"radio"===this.type)b=!0;c=b?"string"===typeof this.checked?this.checked:this.checked?"true":"false":this.value;setTimeout(function(){d=b?"string"===typeof this.checked?this.checked:this.checked?"true":"false":this.value;b&&(e.set(this,"checked",this.checked,c)?e.update(this,"checked",this.checked,c):k.checked.set.call(this,
c));this.value=d;e.set(this,"value",this.value,c)?e.update(this,"value",this.checked,c):k.value.set.call(this,c)}.bind(this),0)};f.removeInputBinding=function(){this.attrListeners()._onkeydown=void 0;this.removeEventListener("keydown",m)};f.addInputBinding=function(){this.attrListeners()._onkeydown=!0;this.addEventListener("keydown",m)};f.removeInputBoxBinding=function(){this.attrListeners()._onmousedown=void 0;this.removeEventListener("mouseup",m)};f.addInputBoxBinding=function(){this.attrListeners()._onmousedown=
!0;this.addEventListener("mouseup",m)}}return h};h.addAttrListener=function(a,c,b){if("html"===a){a=0;for(var d=t.length;a<d;a++)E.call(this,t[a],c,b,!1)}else if("events"===a)for(a=0,d=D.length;a<d;a++)E.call(this,D[a],c,b,!1);else E.call(this,a,c,b,!1);return h};h.addAttrUpdateListener=function(a,c,b){if("html"===a){a=0;for(var d=t.length;a<d;a++)E.call(this,t[a],c,b,!0)}else if("events"===a)for(a=0,d=D.length;a<d;a++)E.call(this,D[a],c,b,!0);else E.call(this,a,c,b,!0);return h};h.removeAttrListener=
function(a,c,b){if("html"===a){a=0;for(var d=t.length;a<d;a++)F.call(this,t[a],c,b,!1)}else if("events"===a)for(a=0,d=D.length;a<d;a++)F.call(this,D[a],c,b,!1);else F.call(this,a,c,b,!1);return h};h.removeAttrUpdateListener=function(a,c,b){if("html"===a){a=0;for(var d=t.length;a<d;a++)F.call(this,t[a],c,b,!0)}else if("events"===a)for(a=0,d=D.length;a<d;a++)F.call(this,D[a],c,b,!0);else F.call(this,a,c,b,!0);return h};h.hasListener=function(a,c,b){"html"===c&&(c="innerHTML");"events"===c&&(c="onclick");
switch(a){case "attr":if(I(z[c],b))return!0;break;case "attrupdate":if(I(y[c],b))return!0}return!1};h.injectedPrototypes=function(){return v};return h}"function"===typeof define&&define.amd&&define("KB",G);return G}();window.define&&window.require?define([],function(){return G}):window.module&&(module.exports=G);return G}();

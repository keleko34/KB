var KB=function(){var H=function(){function H(){function k(a,b){var c=a.length,d;for(d=0;d<c&&(a[d](b),void 0===b._stopPropogation);d++);}function r(a,b){var c=a.length,d;for(d=0;d<c&&(b.child=b.target,b.target=a[d].parent,a[d].func(b),void 0===b._stopPropogation);d++);}function J(a,b){for(var c=a.length;0<c;L++)if(a[L].toString()===b.toString())return!0;return!1}function M(a,b,c,d,f,e,g,h){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=
!0};this.value=c;this.oldValue=d;this.target=a;this.attr=b;this.arguments=f;this.action=e;this.child=void 0;this.type=g;this.stopChange=h}function N(){this._attrListeners={};this._attrUpdateListeners={};this._styleListeners={};this._styleUpdateListeners={};this._parentStyleListeners={};this._parentStyleUpdateListeners={};this._parentAttrListeners={};this._parentAttrUpdateListeners={};this._injectedStyle={}}function R(a,b,c,d){var f=a.get,e=a.set,g;return function(a){g=f.call(this);c(this,b,a,g,void 0,
this._stopChange)&&e.call(this,a);this._stopChange||d(this,b,a,g);this._stopChange=void 0}}function S(a,b,c,d){var f;return function(e){f=a.value;c(this,b,e,f,arguments,this._stopChange)&&(a.value=e);this._stopChange||d(this,b,e,f,arguments);this._stopChange=void 0}}function T(a,b,c,d){var f=a.value,e;return function(){c(this,b,null,null,arguments)&&(e=f.apply(this,arguments));this._stopChange||d(this,b,null,null,arguments,e);this._stopChange=void 0;return e}}function U(a,b,c,d,f){var e=f.style,g=
b.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),h,m;return{get:function(){return m},set:function(a,n){h=m;c(f,b,a,h,void 0,n)&&(m=a,e.setProperty(g,a));n||d(f,b,a,h)},enumerable:!0,configurable:!0}}function F(a,b,c,d){if("function"!==typeof b)return h;var f=-1!==["value","checked"].indexOf(a),e=-1!==w.indexOf(a),g;if(this.toString()!==h.toString())if(c){var u=this.querySelectorAll("*");c=u.length;for(var m,l=0;l<c;l++){m=u[l].attrListeners();if(f||"*"===a)void 0!==u[l].addInputBinding&&u[l].addInputBinding(),
void 0!==u[l].addInputBoxBinding&&u[l].addInputBoxBinding();if(e)h.injectStyleProperty(u[l],a),g=d?"_parentStyleUpdateListeners":"_parentStyleListeners";else{if("*"===a){g=d?"_parentStyleUpdateListeners":"_parentStyleListeners";c=w.length;for(var n=0;n<c;n++)h.injectStyleProperty(u[l],w[n]);void 0===m[g]["*"]&&(m[g]["*"]=[]);m[g]["*"].push({parent:this,func:b})}g=d?"_parentAttrUpdateListeners":"_parentAttrListeners"}void 0===m[g][a]&&(m[g][a]=[]);m[g][a].push({parent:this,func:b})}}else{m=this.attrListeners();
if(e)g=d?"_styleUpdateListeners":"_styleListeners",h.injectStyleProperty(this,a);else{if(f||"*"===a)void 0!==this.addInputBinding&&this.addInputBinding(),void 0!==this.addInputBoxBinding&&this.addInputBoxBinding();if("*"===a){g=d?"_styleUpdateListeners":"_styleListeners";c=w.length;for(l=0;l<c;l++)h.injectStyleProperty(this,w[l]);void 0===m[g][a]&&(m[g][a]=[]);m[g][a].push(b)}g=d?"_attrUpdateListeners":"_attrListeners"}void 0===m[g][a]&&(m[g][a]=[]);m[g][a].push(b)}else{if(f||"*"===a)for(n=document.querySelectorAll("input, textarea"),
c=n.length,l=0;l<c;l++)void 0!==n[l].addInputBinding&&n[l].addInputBinding(),void 0!==n[l].addInputBoxBinding&&n[l].addInputBoxBinding();if(e){e=Array.prototype.slice.call(document.body.querySelectorAll("*"));c=e.length+1;e.unshift(document.body);for(l=0;l<c;l++)h.injectStyleProperty(e[l],a);g=d?B:C}else{if("*"===a){e=Array.prototype.slice.call(document.body.querySelectorAll("*"));c=e.length+1;f=w.length;e.unshift(document.body);for(l=0;l<c;l++)for(n=0;n<f;n++)h.injectStyleProperty(e[l],w[n]);g=d?
B:C;void 0===g[a]&&(g[a]=[]);g[a].push(b)}g=d?x:y}void 0===g[a]&&(g[a]=[]);g[a].push(b)}}function G(a,b,c,d){function f(a,c){var d=c[a],e=d.length;for(g=0;g<e;g++)d[g].toString()===b.toString()&&d.splice(g,1)}if("function"!==typeof b)return h;["value","checked"].indexOf(a);var e=-1!==w.indexOf(a),g;if(this.toString()!==h.toString())if(c){c=this.querySelectorAll("*");var u=c.length;e?(e=d?"_childStyleUpdateListeners":"_childStyleListeners",f(a,this.attrListeners()[e]),e=d?"_parentStyleUpdateListeners":
"_parentStyleListeners"):("*"===a&&(e=d?"_childStyleUpdateListeners":"_childStyleListeners",f(a,this.attrListeners()[e])),e=d?"_childAttrUpdateListeners":"_childAttrListeners",f(a,this.attrListeners()[e]),e=d?"_parentAttrUpdateListeners":"_parentAttrListeners");for(g=0;g<u;g++){for(var m=c[g].attrListeners()[e][a],l=m.length,n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1);if("*"===a)for(listenersStyle=d?"_parentStyleUpdateListeners":"_parentStyleListeners",m=c[g].attrListeners()[e][a],l=m.length,
n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1)}}else e?e=d?"_styleUpdateListeners":"_styleListeners":("*"===a&&(e=d?"_styleUpdateListeners":"_styleListeners",f(a,this.attrListeners()[e])),e=d?"_attrUpdateListeners":"_attrListeners"),f(a,this.attrListeners()[e]);else e?e=d?B:C:("*"===a&&(e=d?B:C,f(a,e)),e=d?x:y),f(a,e)}function O(a,b){h.addAttrListener.call(this,a,b,!0);return this}function P(a,b){h.addAttrUpdateListener.call(this,a,b,!0);return this}function V(a,b){h.removeAttrListener.call(this,
a,b,!0);return this}function W(a,b){h.removeAttrUpdateListener.call(this,a,b,!0);return this}function Q(a,b,c){var d=this.attrListeners();"html"===b&&(b="innerHTML");"events"===b&&(b="onclick");switch(a){case "attr":if(J(d._attrListeners[b],c))return!0;break;case "attrupdate":if(J(d._attrUpdateListeners[b],c))return!0}return!1}function X(){this._stopChange=!0;return this}function h(){function a(a,b){var c,d=b.length;for(c=0;c<d;c++)-1===a.indexOf(b[c])&&a.push(b[c]);return a}function b(b){if(3!==
b.target.nodeType&&8!==b.target.nodeType){var c=b.target.attrListeners(),d,e=["value","checked"],f=c._attrListeners,z=c._attrUpdateListeners,p=c._parentAttrListeners;d=c._parentAttrUpdateListeners;var k=!1;if(void 0!==y["*"]||void 0!==x["*"])k=!0;if(!0!==k&&void 0!==f["*"]||void 0!==z["*"]||void 0!==p["*"]||void 0!==d["*"])k=!0;if(!0!==k)for(var v=0;v<e.length;v++)if(void 0!==y[e[v]]||void 0!==x[e[v]]||void 0!==f[e[v]]||void 0!==z[e[v]]||void 0!==p[e[v]]||void 0!==d[e[v]]){k=!0;break}d=k;e=Object.keys(C);
f=Object.keys(B);Object.keys(c._styleListeners);Object.keys(c._styleUpdateListeners);z=Object.keys(c._parentStyleListeners);c=Object.keys(c._parentStyleUpdateListeners);p=[];if(0!==e.length||0!==f.length)p=a(p,e),p=a(p,f);if(0!==p.length&&0!==z.length||0!==c.length)p=a(p,z),p=a(p,c);-1!==p.indexOf("*")&&(p=w);var c=p,e=c.length,r,A,f=[],q,z="outerHTML"===b.attr||"outerText"===b.attr?b.attr:void 0,p=b.target;void 0!==z&&(b.attr="appendChild",b.arguments=[b.target],b.target=b.target.parentElement);
if(d){"appendChild"===b.attr&&3!==b.arguments[0].nodeType&&8!==b.arguments[0].nodeType?(f=Array.prototype.slice.call(b.arguments[0].querySelectorAll("input,textarea")),"INPUT"!==b.arguments[0].tagName&&"TEXTAREA"!==b.arguments[0].tagName||f.unshift(b.arguments[0])):f=Array.prototype.slice.call(b.target.querySelectorAll("input,textarea"));q=f.length;for(var t=0;t<q;t++)void 0!==f[t].addInputBinding&&f[t].addInputBinding(),void 0!==f[t].addInputBoxBinding&&f[t].addInputBoxBinding()}"appendChild"===
b.attr&&"#text"!==b.arguments[0].nodeName&&"#comment"!==b.arguments[0].nodeName?(f=Array.prototype.slice.call(b.arguments[0].querySelectorAll("*")),f.unshift(b.arguments[0])):f=Array.prototype.slice.call(b.target.querySelectorAll("*"));d=b.target.__kb._parentAttrListeners;k=b.target.__kb._parentAttrUpdateListeners;v=b.target.__kb._parentStyleListeners;r=b.target.__kb._parentStyleUpdateListeners;q=f.length;for(t=0;t<q;t++){if(0!==e)for(A=0;A<e;A++)h.injectStyleProperty(f[t],c[A]);A=f[t].attrListeners();
A._parentAttrListeners=d;A._parentAttrUpdateListeners=k;A._parentStyleListeners=v;A._parentStyleUpdateListeners=r}void 0!==z&&(b.attr=z,b.target=p,b.arguments=[])}}function c(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";f(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])||a.preventDefault()}function d(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";e(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])}h.injectPrototypes(Node,
"Node");h.injectPrototypes(Element,"Element");h.injectPrototypes(HTMLElement,"HTMLElement");h.injectPrototypes(HTMLInputElement,"HTMLInputElement");h.injectPrototypes(HTMLTextAreaElement,"HTMLTextAreaElement");h.injectPrototypes(Document,"Document");var f=K,e=I;h.addAttrUpdateListener("appendChild",b);h.addAttrUpdateListener("removeChild",b);h.addAttrUpdateListener("innerHTML",b);h.addAttrUpdateListener("outerHTML",b);h.addAttrUpdateListener("innerText",b);h.addAttrUpdateListener("outerText",b);h.addAttrUpdateListener("textContent",
b);h.addAttrListener("setAttribute",c);h.addAttrListener("removeAttribute",c);h.addAttrUpdateListener("setAttribute",d);h.addAttrUpdateListener("removeAttribute",d);return h}var y={},x={},C={},B={},q={},D="textContent innerHTML innerText outerHTML outerText appendChild removeChild replaceChild insertAdjacentHTML insertBefore".split(" "),w=Object.getOwnPropertyNames(document.body.style),E=Object.keys(HTMLElement.prototype).filter(function(a){return 0===a.indexOf("on")}).concat(["addEventListener",
"removeEventListener"]),L,K=function(a,b,c,d,f,e){c=new M(a,b,c,d,f,void 0,"set",e);void 0!==a.__kb&&(d=a.__kb._attrListeners,f=a.__kb._styleListeners,e=a.__kb._parentAttrListeners,a=a.__kb._parentStyleListeners,void 0!==d[b]&&k(d[b],c),void 0===c._stopPropogation&&void 0!==f[b]&&k(f[b],c),void 0===c._stopPropogation&&void 0!==d["*"]&&(k(d["*"],c),void 0===c._stopPropogation&&k(f["*"],c)),void 0===c._stopPropogation&&void 0!==e[b]&&r(e[b],c),void 0===c._stopPropogation&&void 0!==a[b]&&r(a[b],c),void 0===
c._stopPropogation&&void 0!==e["*"]&&(r(e["*"],c),void 0===c._stopPropogation&&r(a["*"],c)));void 0===c._stopPropogation&&void 0!==y[b]&&k(y[b],c);void 0===c._stopPropogation&&void 0!==C[b]&&k(C[b],c);void 0===c._stopPropogation&&void 0!==y["*"]&&(k(y["*"],c),void 0===c._stopPropogation&&k(C["*"],c));return void 0!==c._preventDefault?!1:!0},I=function(a,b,c,d,f,e){c=new M(a,b,c,d,f,e,"update");void 0!==a.__kb&&(d=a.__kb._attrUpdateListeners,f=a.__kb._styleUpdateListeners,e=a.__kb._parentAttrUpdateListeners,
a=a.__kb._parentStyleUpdateListeners,void 0!==d[b]&&k(d[b],c),void 0===c._stopPropogation&&void 0!==f[b]&&k(f[b],c),void 0===c._stopPropogation&&void 0!==d["*"]&&(k(d["*"],c),void 0===c._stopPropogation&&k(f["*"],c)),void 0===c._stopPropogation&&void 0!==e[b]&&r(e[b],c),void 0===c._stopPropogation&&void 0!==a[b]&&r(a[b],c),void 0===c._stopPropogation&&void 0!==e["*"]&&(r(e["*"],c),void 0===c._stopPropogation&&r(a["*"],c)));void 0===c._stopPropogation&&void 0!==x[b]&&k(x[b],c);void 0===c._stopPropogation&&
void 0!==B[b]&&k(B[b],c);void 0===c._stopPropogation&&void 0!==x["*"]&&(k(x["*"],c),void 0===c._stopPropogation&&k(B["*"],c));return void 0!==c._preventDefault?!1:!0};h.injectPrototypeProperty=function(a,b,c,d,f){var e=a.prototype,g=Object.getOwnPropertyDescriptor(e,b);c=c||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");var k=q[c];d=d||K;f=f||I;void 0===e.attrListeners&&(e={},e.attrListeners=function(){void 0===this.__kb&&(this.__kb=new N);return this.__kb}.bind(e),e.addAttrListener=
h.addAttrListener,e.addAttrUpdateListener=h.addAttrUpdateListener,e.addChildAttrListener=O,e.addChildAttrUpdateListener=P,e.hasListener=Q,e.removeAttrListener=h.removeAttrListener,e.removeAttrUpdateListener=h.removeAttrUpdateListener,e.removeChildAttrListener=V,e.removeChildAttrUpdateListener=W,e.stopChange=X);void 0===k&&(q[c]={obj:a,proto:e,descriptors:{},set:void 0,update:void 0},k=q[c],k.set=d,k.update=f);void 0===k.descriptors[b]&&(k.descriptors[b]=g);g.configurable&&(void 0!==g.set?Object.defineProperty(e,
b,{get:g.get,set:R(g,b,d,f),enumerable:!0,configurable:!0}):"function"===typeof g.value?Object.defineProperty(e,b,{value:T(g,b,d,f),writable:!0,enumerable:!0,configurable:!0}):void 0!==g.value&&Object.defineProperty(e,b,{get:function(){return g.value},set:S(g,b,d,f),enumerable:!0,configurable:!0}));return h};h.injectStyleProperty=function(a,b,c,d){var f=a.style,e=Object.getOwnPropertyDescriptor(f,b),g=a.attrListeners().injectedStyle;c=c||K;d=d||I;void 0===g&&(a.attrListeners().injectedStyle={obj:a,
proto:f,descriptors:{},set:void 0,update:void 0},a.attrListeners().injectedStyle.set=c,a.attrListeners().injectedStyle.update=d,g=a.attrListeners().injectedStyle);void 0===g.descriptors[b]&&(g.descriptors[b]=e);e.configurable&&Object.defineProperty(f,b,U(e,b,c,d,a));return h};h.injectPrototypes=function(a,b,c,d){var f=a.prototype;b=b||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");var e=q[b],g=Object.getOwnPropertyNames(f);c=c||K;d=d||I;var k;void 0===f.attrListeners&&(f.attrListeners=
function(){void 0===this.__kb&&(this.__kb=new N);return this.__kb},f.addAttrListener=h.addAttrListener,f.addAttrUpdateListener=h.addAttrUpdateListener,f.addChildAttrListener=O,f.addChildAttrUpdateListener=P,f.hasListener=Q);void 0===e&&(q[b]={obj:a,proto:f,descriptors:{},set:void 0,update:void 0},e=q[b],e.set=c,e.update=d);k=q[b].descriptors;for(d=0;d<g.length;d+=1)void 0===k[g[d]]&&h.injectPrototypeProperty(a,g[d],b,c,I);if(-1!==g.indexOf("value")){var m=function(a){var b,c,d;if("checkbox"===this.type||
"radio"===this.type)b=!0;c=b?"string"===typeof this.checked?this.checked:this.checked?"true":"false":this.value;setTimeout(function(){d=b?"string"===typeof this.checked?this.checked:this.checked?"true":"false":this.value;b&&(e.set(this,"checked",this.checked,c)?e.update(this,"checked",this.checked,c):k.checked.set.call(this,c));this.value=d;e.set(this,"value",this.value,c)?e.update(this,"value",this.checked,c):k.value.set.call(this,c)}.bind(this),0)};f.removeInputBinding=function(){this.attrListeners()._onkeydown=
void 0;this.removeEventListener("keydown",m)};f.addInputBinding=function(){this.attrListeners()._onkeydown=!0;this.addEventListener("keydown",m)};f.removeInputBoxBinding=function(){this.attrListeners()._onmousedown=void 0;this.removeEventListener("mouseup",m)};f.addInputBoxBinding=function(){this.attrListeners()._onmousedown=!0;this.addEventListener("mouseup",m)}}return h};h.addAttrListener=function(a,b,c){if("html"===a){a=0;for(var d=D.length;a<d;a++)F.call(this,D[a],b,c,!1)}else if("events"===a)for(a=
0,d=E.length;a<d;a++)F.call(this,E[a],b,c,!1);else F.call(this,a,b,c,!1);return h};h.addAttrUpdateListener=function(a,b,c){if("html"===a){a=0;for(var d=D.length;a<d;a++)F.call(this,D[a],b,c,!0)}else if("events"===a)for(a=0,d=E.length;a<d;a++)F.call(this,E[a],b,c,!0);else F.call(this,a,b,c,!0);return h};h.removeAttrListener=function(a,b,c){if("html"===a){a=0;for(var d=D.length;a<d;a++)G.call(this,D[a],b,c,!1)}else if("events"===a)for(a=0,d=E.length;a<d;a++)G.call(this,E[a],b,c,!1);else G.call(this,
a,b,c,!1);return h};h.removeAttrUpdateListener=function(a,b,c){if("html"===a){a=0;for(var d=D.length;a<d;a++)G.call(this,D[a],b,c,!0)}else if("events"===a)for(a=0,d=E.length;a<d;a++)G.call(this,E[a],b,c,!0);else G.call(this,a,b,c,!0);return h};h.hasListener=function(a,b,c){"html"===b&&(b="innerHTML");"events"===b&&(b="onclick");switch(a){case "attr":if(J(y[b],c))return!0;break;case "attrupdate":if(J(x[b],c))return!0}return!1};h.injectedPrototypes=function(){return q};return h}"function"===typeof define&&
define.amd&&define("KB",H);return H}();window.define&&window.require?define([],function(){return H}):window.module&&(module.exports=H);return H}();

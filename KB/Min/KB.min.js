var CreateKB=function(){function r(){function b(){var n=function(c,q,a,d,n,b){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};this.value=a;this.oldValue=d;this.target=c;this.attr=q;this.arguments=n;this.action=b},d=function(c,q,a,d,b){a=new n(c,q,a,d,b);d=!0;if(void 0!==l[q])for(e=0;e<l[q].length;e+=1){l[q][e].call(c,a);if(a._stopPropogation)break;a._preventDefault&&(d=!1)}return d},p=function(c,a,d,b,e,f){d=new n(c,a,d,b,e,f);if(void 0!==
m[a])for(b=0;b<m[a].length;b+=1){m[a][b].call(c,d);if(d._stopPropogation)break;if(d._preventDefault)return!1}return!0},k=function(){for(var c=0,a=Array.prototype.slice.call(document.getElementsByTagName("INPUT")).filter(function(c){return"radio"!==c.type&&"checkbox"!==c.type}).concat(Array.prototype.slice.call(document.getElementsByTagName("TEXTAREA"))),d=Array.prototype.slice.call(document.getElementsByTagName("INPUT")).filter(function(c){return"radio"===c.type||"checkbox"===c.type}),c=0;c<a.length;c++)void 0===
a[c].kb_onkeydown&&a[c].kb_addInputBinding();for(c=0;c<d.length;c++)void 0===d[c].kb_onmousedown&&d[c].kb_addInputBoxBinding()},h=function(c){var a=new n(c.target,c.arguments[0],"setAttribute"===c.attr?c.arguments[1]:"",c.target.getAttribute(c.arguments[0]),"setAttribute"===c.attr?[c.arguments[1]]:[""]);if(void 0!==l[a.attr])for(e=0;e<l[a.attr].length;e+=1)l[a.attr][e].call(a.target,a),a._stopPropogation&&c.stopPropagation(),a._preventDefault&&c.preventDefault()},g=function(c){var a=new n(c.target,
c.arguments[0],"setAttribute"===c.attr?c.arguments[1]:"",c.target.getAttribute(c.arguments[0]),"setAttribute"===c.attr?[c.arguments[1]]:[""]);if(void 0!==m[a.attr])for(e=0;e<m[a.attr].length;e+=1)m[a.attr][e].call(a.target,a),a._stopPropogation&&c.stopPropagation()};b.injectPrototypes(HTMLInputElement,d,p);b.injectPrototypes(HTMLTextAreaElement,d,p);b.injectPrototypes(Node,d,p);b.injectPrototypes(Element,d,p);b.injectPrototypes(HTMLElement,d,p);b.injectPrototypes(Document,d,p);var f=Object.keys(a);
for(e=0;e<f.length;e++)void 0===a[f[e]].set&&b.injectPrototypes(a[f[e]].obj,d,p);Object.keys(a).forEach(function(a,d){});b.addAttrUpdateListener("appendChild",k);b.addAttrUpdateListener("removeChild",k);b.addAttrUpdateListener("innerHTML",k);b.addAttrUpdateListener("outerHTML",k);b.addAttrUpdateListener("innerText",k);b.addAttrUpdateListener("outerText",k);b.addAttrUpdateListener("textContent",k);b.addAttrListener("setAttribute",h);b.addAttrListener("removeAttribute",h);b.addAttrUpdateListener("setAttribute",
g);b.addAttrUpdateListener("removeAttribute",g);k()}var l={},m={},a={},e;b.injectPrototypeProperty=function(b,d,e,k){var h=b.prototype,g=Object.getOwnPropertyDescriptor(h,d),f=b.toString().split(/\s+/)[1].split("{")[0].replace("()","");void 0===a[f]&&(a[f]={obj:b,proto:h,descriptors:{},set:void 0,update:void 0});a[f].set=void 0!==e?e:a[f].set;a[f].update=void 0!==k?k:a[f].update;a[f].descriptors[d]=g;void 0!==g.set&&g.configurable?Object.defineProperty(h,d,{get:g.get,set:function(c){var b=g.get.apply(this);
"function"==typeof a[f].set&&a[f].set(this,d,c,b,arguments)&&g.set.apply(this,arguments);"function"===typeof a[f].update&&a[f].update(this,d,c,b)},enumerable:!0,configurable:!0}):"function"===typeof g.value?Object.defineProperty(h,d,{value:function(){var c=null;"function"==typeof a[f].set&&a[f].set(this,d,null,null,arguments)&&(c=g.value.apply(this,arguments));"function"===typeof a[f].update&&a[f].update(this,d,null,null,arguments,c);return c},writable:!0,enumerable:!0,configurable:!0}):void 0!==
g.value&&g.configurable&&Object.defineProperty(h,d,{get:function(){return g.value},set:function(c){var b=g.value;"function"==typeof a[f].set&&a[f].set(this,d,c,b)&&(g.value=c);"function"===typeof a[f].update&&a[f].update(this,d,c,b)},enumerable:!0,configurable:!0})};b.injectPrototypes=function(n,d,p){var k=n.prototype,h=n.toString().split(/\s+/)[1].split("{")[0].replace("()",""),g=Object.keys(k),f={},c=function(c){var b=!1,d="false";if("checkbox"===this.type||"radio"===this.type)d=this.checked,b=
!0;var e=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;setTimeout(function(){b&&!a[h].set(this,"checked",this.checked,d)?f.checked.set.call(this,d):b&&"function"===typeof a[h].update&&a[h].update(this,"checked",this.checked,e);this.value=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;a[h].set(this,"value",this.value,e)?"function"===typeof a[h].update&&a[h].update(this,"value",this.value,e):
f.value.set.call(this,e)}.bind(this),0)};void 0===a[h]&&(a[h]={obj:n,proto:k,descriptors:{},set:void 0,update:void 0});a[h].set=d;a[h].update=p;-1<g.indexOf("value")&&(Object.defineProperty(k,"kb_removeInputBinding",{value:function(){this.kb_onkeydown=void 0;this.removeEventListener("keydown",c)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_addInputBinding",{value:function(){this.kb_onkeydown=!0;this.addEventListener("keydown",c)},configurable:!0,enumerable:!0}),Object.defineProperty(k,
"kb_removeInputBoxBinding",{value:function(){this.kb_onmousedown=void 0;this.removeEventListener("mouseup",c)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_addInputBoxBinding",{value:function(){this.kb_onmousedown=!0;this.addEventListener("mouseup",c)},configurable:!0,enumerable:!0}));for(e=0;e<g.length;e+=1)void 0===a[h].descriptors[g[e]]&&b.injectPrototypeProperty(n,g[e]);return b};b.injectedPrototypes=function(){return a};b.addAttrListener=function(a,d){void 0===l[a]&&(l[a]=[]);
"function"===typeof d&&l[a].push(d);return b};b.addAttrUpdateListener=function(a,d){void 0===m[a]&&(m[a]=[]);"function"===typeof d&&m[a].push(d);return b};b.removeAttrListener=function(a,b){if(void 0!==l[a]&&"function"===typeof b)for(var e=0;e<l[a].length;e+=1)l[a][e].toString()===b.toString()&&l[a].splice(e,1)};b.removeAttrUpdateListener=function(a,b){if(void 0!==m[a]&&"function"===typeof b)for(var e=0;e<m[a].length;e+=1)m[a][e].toString()===b.toString()&&m[a].splice(e,1)};return b}"function"===
typeof define&&define.amd?(define("KB",r),define([],r)):"object"===typeof module&&module.exports&&(module.exports=r);return r}();

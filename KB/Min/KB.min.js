var CreateKB=function(){function v(){function d(){function a(a){if("outerHTML"===a.attr||"outerText"===a.attr)a.target=a.target.parentElement;var k=0,k=a.target,c=k.getElementsByTagName("INPUT"),d=k.getElementsByTagName("TEXTAREA"),d=e(c,d,a),c=b(c,a),f=[],k=k.querySelectorAll("*"),h=k.length,g,m=0;for(g=0;g<h;g++)3!==k[g].nodeType&&8!==k[g].nodeType&&(f[m]=k[g],m++);"appendChild"===a.attr&&(k=a.arguments[0].nodeType,3!==k&&8!==k&&(f[f.length]=a.arguments[0]));for(k=0;k<d.length;k++)d[k].kb_addInputBinding();
for(k=0;k<c.length;k++)c[k].kb_addInputBoxBinding();n(f)}function e(a,b,c){var e=a.length,d=[],f,h=0;for(f=0;f<e;f++){var g=a[f].type;"radio"!==g&&"checkbox"!==g&&void 0===a[f].kb_onkeydown&&void 0===a[f].kb_onmousedown&&(d[h]=a[f],h++)}for(f=0;f<b;f++)d[h]=b[f],h++;"appendChild"===c.attr&&(a=c.arguments[0],b=a.tagName,"INPUT"===b&&"checkbox"!==a.type&&"radio"!==a.type||"TEXTAREA"===b)&&(d[d.length]=a);return d}function b(a,b){var c=a.length,e=[],d,f=0;for(d=0;d<c;d++){var h=a[d].type;if("radio"===
h||"checkbox"===h&&void 0===a[d].kb_onkeydown&&void 0===a[d].kb_onmousedown)e[f]=a[d],f++}"appendChild"===b.attr&&(c=b.arguments[0],"INPUT"===c.tagName&&"checkbox"===c.type&&"radio"===c.type&&(e[e.length]=c));return e}function n(a){for(var b=a.length,c=w.length,e=0;e<b;e++)for(var f=0;f<c;f++)d.injectStyle(a[e],w[f],q,r)}function h(a){var b=a.target.getAttribute(a.arguments[0]);setTimeout(function(){q(a.target,a.arguments[0],"setAttribute"===a.attr?a.arguments[1]:"",b,"setAttribute"===a.attr?[a.arguments[1]]:
[""])},0)}function c(a){var b=a.target.getAttribute(a.arguments[0]);setTimeout(function(){q(a.target,a.arguments[0],"setAttribute"===a.attr?a.arguments[1]:"",b,"setAttribute"===a.attr?[a.arguments[1]]:[""])},0)}var f=Object.keys(m);for(g=0;g<f.length;g++)void 0===m[f[g]].set&&d.injectPrototypes(m[f[g]].obj,q,r);d.addAttrUpdateListener("appendChild",a);d.addAttrUpdateListener("removeChild",a);d.addAttrUpdateListener("innerHTML",a);d.addAttrUpdateListener("outerHTML",a);d.addAttrUpdateListener("innerText",
a);d.addAttrUpdateListener("outerText",a);d.addAttrUpdateListener("textContent",a);d.addAttrListener("setAttribute",h);d.addAttrListener("removeAttribute",h);d.addAttrUpdateListener("setAttribute",c);d.addAttrUpdateListener("removeAttribute",c);n(document.all);(function(){for(var a=0,a=document.getElementsByTagName("INPUT"),c=document.getElementsByTagName("TEXTAREA"),d={attr:"initial"},c=e(a,c,d),d=b(a,d),a=0;a<c.length;a++)c[a].kb_addInputBinding();for(a=0;a<d.length;a++)d[a].kb_addInputBoxBinding()})()}
function v(a,e){d.addAttrListener.call(this,a,e,!0)}function z(a,e){d.addAttrUpdateListener.call(this,a,e,!0)}var p={},t={},m={},w=Object.getOwnPropertyNames(document.all[0].style),g,u,x=function(a,e,b){var d=[],h=0;b=b?"kb_childAttrUpdateListeners":"kb_childAttrListeners";for(h=0;null!==a;)a=a.parentElement,null!==a&&void 0!==a[b]()[e]&&(d[h]=a,h++);return d},y=function(a,e,b,d,h,c,f){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};
this.value=b;this.oldValue=d;this.target=a;this.attr=e;this.arguments=h;this.action=c;this.child=void 0;this.type=f},q=function(a,d,b,n,h){b=new y(a,d,b,n,h,"set");n=void 0!==a.parentElement?x(a,d):[];h=n.length;var c=p["*"],f,l=p[d],k=void 0!==a.kb_attrListeners?a.kb_attrListeners()[d]:void 0;if(void 0!==c)a:for(f=c.length,g=0;g<f;g+=1)if(c[g].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==l&&void 0===b._stopPropogation)a:for(c=l.length,g=0;g<c;g+=1)if(l[g].call(a,b),void 0!==b._stopPropogation)break a;
if(void 0!==k&&void 0===b._stopPropogation)a:for(l=k.length,g=0;g<l;g+=1)if(k[g].call(a,b),void 0!==b._stopPropogation)break a;if(0<h&&void 0===b._stopPropogation)a:for(g=0;g<h;g++)if(k=n[g],l=k.kb_childAttrListeners()[d],void 0!==l)for(c=l.length,u=0;u<c;u++)if(b.child=a,b.target=k,l[u].call(k,b),void 0!==b._stopPropogation)break a;return void 0!==b._preventDefault?!1:!0},r=function(a,d,b,g,h,c){b=new y(a,d,b,g,h,c,"update");g=void 0!==a.parentElement?x(a,d,!0):[];h=g.length;var f=p["*"],l,k=p[d],
m=void 0!==a.kb_attrUpdateListeners?a.kb_attrUpdateListeners()[d]:void 0;if(void 0!==f)a:for(l=f.length,c=0;c<l;c+=1)if(f[c].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==k&&void 0===b._stopPropogation)a:for(f=k.length,c=0;c<f;c+=1)if(k[c].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==m&&void 0===b._stopPropogation)a:for(k=m.length,c=0;c<k;c+=1)if(m[c].call(a,b),void 0!==b._stopPropogation)break a;if(0<h&&void 0===b._stopPropogation)a:for(c=0;c<h;c++)if(m=g[c],k=m.kb_childAttrUpdateListeners()[d],
void 0!==k)for(f=k.length,u=0;u<f;u++)if(b.child=a,b.target=m,k[u].call(m,b),void 0!==b._stopPropogation)break a;return void 0!==b._preventDefault?!1:!0};d.injectPrototypeProperty=function(a,e,b,g,h){var c=a.prototype,f=Object.getOwnPropertyDescriptor(c,e);h=h||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");var l=m[h];void 0===c.addAttrListener&&void 0===c.kb_attrListeners&&(c.kb_attrListeners=function(){void 0===this._kb_attrListeners&&(this._kb_attrListeners={});return this._kb_attrListeners},
c.addAttrListener=d.addAttrListener,c.removeAttrListener=d.removeAttrListener);c.hasOwnProperty("children")&&void 0===c.addChildAttrListener&&void 0===c.kb_childAttrListeners&&(c.kb_childAttrListeners=function(){void 0===this._kb_childAttrListeners&&(this._kb_childAttrListeners={});return this._kb_childAttrListeners},c.addChildAttrListener=v,c.getchildAttrListeners=function(){return this.kb_childAttrListeners()});void 0===c.addAttrUpdateListener&&void 0===c.kb_attrUpdateListeners&&(c.kb_attrUpdateListeners=
function(){void 0===this._kb_attrUpdateListeners&&(this._kb_attrUpdateListeners={});return this._kb_attrUpdateListeners},c.addAttrUpdateListener=d.addAttrUpdateListener,c.removeAttrUpdateListener=d.removeAttrUpdateListener);c.hasOwnProperty("children")&&void 0===c.addChildAttrUpdateListener&&void 0===c.kb_childAttrUpdateListeners&&(c.kb_childAttrUpdateListeners=function(){void 0===this._kb_childAttrUpdateListeners&&(this._kb_childAttrUpdateListeners={});return this._kb_childAttrUpdateListeners},c.addChildAttrUpdateListener=
z,c.getchildAttrUpdateListeners=function(){return this.kb_childAttrUpdateListeners()});void 0===l&&(m[h]={obj:a,proto:c,descriptors:{},set:void 0,update:void 0},l=m[h]);l.set=b?b:m[h].set;l.update=g?g:m[h].update;l.descriptors[e]=f;void 0!==f.set&&f.configurable?Object.defineProperty(c,e,{get:f.get,set:function(a){var b=f.get.apply(this),c=l.set,d=l.update;"function"===typeof c&&c(this,e,a,b,arguments)&&f.set.apply(this,arguments);"function"===typeof d&&d(this,e,a,b,arguments)},enumerable:!0,configurable:!0}):
"function"===typeof f.value?Object.defineProperty(c,e,{value:function(){var a=null,b=l.set,c=l.update;"function"===typeof b&&b(this,e,null,null,arguments)&&(a=f.value.apply(this,arguments));"function"===typeof c&&c(this,e,null,null,arguments,a);return a},writable:!0,enumerable:!0,configurable:!0}):void 0!==f.value&&f.configurable&&Object.defineProperty(c,e,{get:function(){return f.value},set:function(a){var b=f.value,c=l.set,d=l.update;"function"===typeof c&&c(this,e,a,b)&&(f.value=a);"function"===
typeof d&&d(this,e,a,b)},enumerable:!0,configurable:!0})};d.injectPrototypes=function(a,e,b){var n=a.prototype,h=a.toString().split(/\s+/)[1].split("{")[0].replace("()",""),c=m[h],f=Object.getOwnPropertyNames(n),l={},k=function(a){var b=!1,d="false";if("checkbox"===this.type||"radio"===this.type)d=this.checked,b=!0;var e=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;setTimeout(function(){var a=c.set,f=c.update;b&&!a(this,"checked",this.checked,
d)?l.checked.set.call(this,d):b&&"function"===typeof f&&f(this,"checked",this.checked,e);this.value=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;a(this,"value",this.value,e)?"function"===typeof f&&f(this,"value",this.value,e):l.value.set.call(this,e)}.bind(this),0)};void 0===c&&(m[h]={obj:a,proto:n,descriptors:{},set:void 0,update:void 0},c=m[h]);c.set=e||q;c.update=b||r;-1<f.indexOf("value")&&(Object.defineProperty(n,"kb_removeInputBinding",
{value:function(){this.kb_onkeydown=void 0;this.removeEventListener("keydown",k)},configurable:!0,enumerable:!0}),Object.defineProperty(n,"kb_addInputBinding",{value:function(){this.kb_onkeydown=!0;this.addEventListener("keydown",k)},configurable:!0,enumerable:!0}),Object.defineProperty(n,"kb_removeInputBoxBinding",{value:function(){this.kb_onmousedown=void 0;this.removeEventListener("mouseup",k)},configurable:!0,enumerable:!0}),Object.defineProperty(n,"kb_addInputBoxBinding",{value:function(){this.kb_onmousedown=
!0;this.addEventListener("mouseup",k)},configurable:!0,enumerable:!0}));for(g=0;g<f.length;g+=1)void 0===m[h].descriptors[f[g]]&&d.injectPrototypeProperty(a,f[g],null,null,h);return d};d.injectStyle=function(a,e,b,g){var h=Object.getOwnPropertyDescriptor(a.style,e),c=a.style;void 0===a.style.kb_bind&&(a.style.kb_bind={obj:a,proto:c,descriptors:{},set:void 0,update:void 0});a.style.kb_bind.set=b?b:m[_injectName].set;a.style.kb_bind.update=g?g:m[_injectName].update;a.style.kb_bind.descriptors[e]=h;
void 0!==h.value&&h.configurable&&Object.defineProperty(c,e,{get:function(){return h.value},set:function(b){var c=h.value;"function"==typeof a.style.kb_bind.set&&a.style.kb_bind.set(a,e,b,c)&&(h.value=b,a.style.setProperty(e.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),b));"function"===typeof a.style.kb_bind.update&&a.style.kb_bind.update(a,e,b,c)},enumerable:!0,configurable:!0});return d};d.injectedPrototypes=function(){return m};d.addAttrListener=function(a,e,b){if(this.toString()!==d.toString())return void 0===
this.kb_attrListeners()[a]&&(this.kb_attrListeners()[a]=[]),b&&void 0===this.kb_childAttrListeners()[a]&&(this.kb_childAttrListeners()[a]=[]),"function"===typeof e&&(b?this.kb_childAttrListeners()[a].push(e):this.kb_attrListeners()[a].push(e)),this;void 0===p[a]&&(p[a]=[]);"function"===typeof e&&p[a].push(e);return d};d.addAttrUpdateListener=function(a,e,b){if(this.toString()!==d.toString())return void 0===this.kb_attrUpdateListeners()[a]&&(this.kb_attrUpdateListeners()[a]=[]),b&&void 0===this.kb_childAttrUpdateListeners()[a]&&
(this.kb_childAttrUpdateListeners()[a]=[]),"function"===typeof e&&(b?this.kb_childAttrUpdateListeners()[a].push(e):this.kb_attrUpdateListeners()[a].push(e)),this;void 0===t[a]&&(t[a]=[]);"function"===typeof e&&t[a].push(e);return d};d.getAttrListeners=function(){return this.toString()!==d.toString()?this.kb_attrListeners():p};d.getAttrUpdateListeners=function(){return this.toString()!==d.toString()?this.kb_attrUpdateListeners():t};d.removeAttrListener=function(a,e){if(this.toString()!==d.toString()){if(void 0!==
this.kb_attrListeners&&void 0!==this.kb_attrListeners()[a]&&"function"===typeof e){for(var b=0;b<this.kb_attrListeners()[a].length;b+=1)this.kb_attrListeners()[a][b].toString()===e.toString()&&this.kb_attrListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrListeners()[a])for(b=0;b<this.kb_childAttrListeners()[a].length;b+=1)this.kb_childAttrListeners()[a][b].toString()===e.toString()&&this.kb_childAttrListeners()[a].splice(b,1)}return this}if(void 0!==p[a]&&"function"===typeof e)for(b=0;b<p[a].length;b+=
1)p[a][b].toString()===e.toString()&&p[a].splice(b,1);return d};d.removeAttrUpdateListener=function(a,e){if(this.toString()!==d.toString()){if(void 0!==this.kb_attrUpdateListeners&&void 0!==this.kb_attrUpdateListeners()[a]&&"function"===typeof e){for(var b=0;b<this.kb_attrUpdateListeners()[a].length;b+=1)this.kb_attrUpdateListeners()[a][b].toString()===e.toString()&&this.kb_attrUpdateListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrUpdateListeners()[a])for(b=0;b<this.kb_childAttrUpdateListeners()[a].length;b+=
1)this.kb_childAttrUpdateListeners()[a][b].toString()===e.toString()&&this.kb_childAttrUpdateListeners()[a].splice(b,1)}return this}if(void 0!==t[a]&&"function"===typeof e)for(b=0;b<t[a].length;b+=1)t[a][b].toString()===e.toString()&&t[a].splice(b,1);return d};d.injectPrototypes(Node,q,r);d.injectPrototypes(Element,q,r);d.injectPrototypes(HTMLElement,q,r);d.injectPrototypes(HTMLInputElement,q,r);d.injectPrototypes(HTMLTextAreaElement,q,r);d.injectPrototypes(Document,q,r);return d}"function"===typeof define&&
define.amd?(define("KB",v),define([],function(){return v})):"object"===typeof module&&module.exports&&(module.exports=v);return v}();

var CreateKB=function(){function t(){function e(){function a(a){var d=a.arguments[0];if("appendChild"!==a.attr||"SCRIPT"!==d.tagName&&"LINK"!==d.tagName&&"#text"!==d.nodeName&&"#comment"!==d.nodeName){if("outerHTML"===a.attr||"outerText"===a.attr)a.target=a.target.parentElement;var c=0,c=a.target,e="appendChild"!==a.attr?c.getElementsByTagName("INPUT"):a.arguments[0].getElementsByTagName("INPUT"),d="appendChild"!==a.attr?c.getElementsByTagName("TEXTAREA"):a.arguments[0].getElementsByTagName("TEXTAREA"),
d=f(e,d,a),e=b(e,a),g=[],c="appendChild"!==a.attr?c.querySelectorAll("*"):a.arguments[0].querySelectorAll("*"),h=c.length,u,k=0;for(u=0;u<h;u++)3!==c[u].nodeType&&8!==c[u].nodeType&&(g[k]=c[u],k++);"appendChild"===a.attr&&(c=a.arguments[0].nodeType,3!==c&&8!==c&&(g[g.length]=a.arguments[0]));for(c=0;c<d.length;c++)d[c].kb_addInputBinding();for(c=0;c<e.length;c++)e[c].kb_addInputBoxBinding();n(g)}else a.stopPropagation()}function f(a,b,c){var d=a.length,f=b.length,e=[],g,n=0;for(g=0;g<d;g++){var h=
a[g].type;"radio"!==h&&"checkbox"!==h&&void 0===a[g].kb_onkeydown&&void 0===a[g].kb_onmousedown&&(e[n]=a[g],n++)}for(g=0;g<f;g++)e[n]=b[g],n++;"appendChild"===c.attr&&(a=c.arguments[0],b=a.tagName,"INPUT"===b&&"checkbox"!==a.type&&"radio"!==a.type||"TEXTAREA"===b)&&(e[e.length]=a);return e}function b(a,b){var c=a.length,d=[],f,e=0;for(f=0;f<c;f++){var g=a[f].type;if("radio"===g||"checkbox"===g&&void 0===a[f].kb_onkeydown&&void 0===a[f].kb_onmousedown)d[e]=a[f],e++}"appendChild"===b.attr&&(c=b.arguments[0],
"INPUT"===c.tagName&&"checkbox"===c.type&&"radio"===c.type&&(d[d.length]=c));return d}function n(a){for(var b=a.length,c=w.length,d=0;d<b;d++)for(var f=0;f<c;f++)e.injectStyle(a[d],w[f],p,q)}function c(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";p(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])||a.preventDefault()}function d(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";q(a.target,a.arguments[0],c,void 0!==
b?b.value:"",[c])}var g=Object.keys(k);for(h=0;h<g.length;h++)void 0===k[g[h]].set&&e.injectPrototypes(k[g[h]].obj,p,q);e.addAttrUpdateListener("appendChild",a);e.addAttrUpdateListener("removeChild",a);e.addAttrUpdateListener("innerHTML",a);e.addAttrUpdateListener("outerHTML",a);e.addAttrUpdateListener("innerText",a);e.addAttrUpdateListener("outerText",a);e.addAttrUpdateListener("textContent",a);e.addAttrListener("setAttribute",c);e.addAttrListener("removeAttribute",c);e.addAttrUpdateListener("setAttribute",
d);e.addAttrUpdateListener("removeAttribute",d);(function(){var a=Array.prototype.slice.call(document.body.querySelectorAll("*"));a.unshift(document.body);n(a)})();(function(){for(var a=0,a=document.getElementsByTagName("INPUT"),c=document.getElementsByTagName("TEXTAREA"),d={attr:"initial"},c=f(a,c,d),d=b(a,d),a=0;a<c.length;a++)c[a].kb_addInputBinding();for(a=0;a<d.length;a++)d[a].kb_addInputBoxBinding()})()}function t(a,f){e.addAttrListener.call(this,a,f,!0)}function z(a,f){e.addAttrUpdateListener.call(this,
a,f,!0)}var l={},r={},k={},w=Object.getOwnPropertyNames(document.all[0].style),h,v,x=function(a,f,b,e){b=b?"kb_childAttrUpdateListeners":"kb_childAttrListeners";var c,d;e.child=a;a:for(;null!==a&&void 0!==a;)if(a=a.parentElement,null!==a&&void 0!==a&&(c=a[b]()[f],void 0!==c))for(d=c.length,v=0;v<d;v++)if(e.target=a,c[v].call(a,e),void 0!==e._stopPropogation)break a},y=function(a,f,b,e,c,d,g){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=
!0};this.value=b;this.oldValue=e;this.target=a;this.attr=f;this.arguments=c;this.action=d;this.child=void 0;this.type=g},p=function(a,f,b,e,c){b=new y(a,f,b,e,c,"set");var d=l["*"],g;c=l[f];e=void 0!==a.kb_attrListeners?a.kb_attrListeners()[f]:void 0;if(void 0!==d)a:for(g=d.length,h=0;h<g;h+=1)if(d[h].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==c&&void 0===b._stopPropogation)a:for(d=c.length,h=0;h<d;h+=1)if(c[h].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==e&&void 0===b._stopPropogation)a:for(c=
e.length,h=0;h<c;h+=1)if(e[h].call(a,b),void 0!==b._stopPropogation)break a;x(a,f,!1,b);return void 0!==b._preventDefault?!1:!0},q=function(a,f,b,e,c,d){b=new y(a,f,b,e,c,d,"update");var g=r["*"],h;d=r[f];e=void 0!==a.kb_attrUpdateListeners?a.kb_attrUpdateListeners()[f]:void 0;if(void 0!==g)a:for(h=g.length,c=0;c<h;c+=1)if(g[c].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==d&&void 0===b._stopPropogation)a:for(g=d.length,c=0;c<g;c+=1)if(d[c].call(a,b),void 0!==b._stopPropogation)break a;
if(void 0!==e&&void 0===b._stopPropogation)a:for(d=e.length,c=0;c<d;c+=1)if(e[c].call(a,b),void 0!==b._stopPropogation)break a;x(a,f,!0,b);return void 0!==b._preventDefault?!1:!0};e.injectPrototypeProperty=function(a,f,b,h,c){var d=a.prototype,g=Object.getOwnPropertyDescriptor(d,f);c=c||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");var m=k[c];void 0===d.addAttrListener&&void 0===d.kb_attrListeners&&(d.kb_attrListeners=function(){void 0===this._kb_attrListeners&&(this._kb_attrListeners=
{});return this._kb_attrListeners},d.addAttrListener=e.addAttrListener,d.removeAttrListener=e.removeAttrListener);d.hasOwnProperty("children")&&void 0===d.addChildAttrListener&&void 0===d.kb_childAttrListeners&&(d.kb_childAttrListeners=function(){void 0===this._kb_childAttrListeners&&(this._kb_childAttrListeners={});return this._kb_childAttrListeners},d.addChildAttrListener=t,d.getchildAttrListeners=function(){return this.kb_childAttrListeners()});void 0===d.addAttrUpdateListener&&void 0===d.kb_attrUpdateListeners&&
(d.kb_attrUpdateListeners=function(){void 0===this._kb_attrUpdateListeners&&(this._kb_attrUpdateListeners={});return this._kb_attrUpdateListeners},d.addAttrUpdateListener=e.addAttrUpdateListener,d.removeAttrUpdateListener=e.removeAttrUpdateListener);d.hasOwnProperty("children")&&void 0===d.addChildAttrUpdateListener&&void 0===d.kb_childAttrUpdateListeners&&(d.kb_childAttrUpdateListeners=function(){void 0===this._kb_childAttrUpdateListeners&&(this._kb_childAttrUpdateListeners={});return this._kb_childAttrUpdateListeners},
d.addChildAttrUpdateListener=z,d.getchildAttrUpdateListeners=function(){return this.kb_childAttrUpdateListeners()});void 0===m&&(k[c]={obj:a,proto:d,descriptors:{},set:void 0,update:void 0},m=k[c]);m.set=b?b:k[c].set;m.update=h?h:k[c].update;m.descriptors[f]=g;void 0!==g.set&&g.configurable?Object.defineProperty(d,f,{get:g.get,set:function(a){var b=g.get.apply(this),c=m.set,d=m.update;"function"===typeof c&&c(this,f,a,b,arguments)&&g.set.apply(this,arguments);"function"===typeof d&&d(this,f,a,b,arguments)},
enumerable:!0,configurable:!0}):"function"===typeof g.value?Object.defineProperty(d,f,{value:function(){var a=null,b=m.set,c=m.update;"function"===typeof b&&b(this,f,null,null,arguments)&&(a=g.value.apply(this,arguments));"function"===typeof c&&c(this,f,null,null,arguments,a);return a},writable:!0,enumerable:!0,configurable:!0}):void 0!==g.value&&g.configurable&&Object.defineProperty(d,f,{get:function(){return g.value},set:function(a){var b=g.value,c=m.set,d=m.update;"function"===typeof c&&c(this,
f,a,b)&&(g.value=a);"function"===typeof d&&d(this,f,a,b)},enumerable:!0,configurable:!0})};e.injectPrototypes=function(a,f,b){var n=a.prototype,c=a.toString().split(/\s+/)[1].split("{")[0].replace("()",""),d=k[c],g=Object.getOwnPropertyNames(n),m={},l=function(a){var b=!1,c="false";if("checkbox"===this.type||"radio"===this.type)c=this.checked,b=!0;var e=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;setTimeout(function(){var a=d.set,f=d.update;
b&&!a(this,"checked",this.checked,c)?m.checked.set.call(this,c):b&&"function"===typeof f&&f(this,"checked",this.checked,e);this.value=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;a(this,"value",this.value,e)?"function"===typeof f&&f(this,"value",this.value,e):m.value.set.call(this,e)}.bind(this),0)};void 0===d&&(k[c]={obj:a,proto:n,descriptors:{},set:void 0,update:void 0},d=k[c]);d.set=f||p;d.update=b||q;-1<g.indexOf("value")&&(Object.defineProperty(n,
"kb_removeInputBinding",{value:function(){this.kb_onkeydown=void 0;this.removeEventListener("keydown",l)},configurable:!0,enumerable:!0}),Object.defineProperty(n,"kb_addInputBinding",{value:function(){this.kb_onkeydown=!0;this.addEventListener("keydown",l)},configurable:!0,enumerable:!0}),Object.defineProperty(n,"kb_removeInputBoxBinding",{value:function(){this.kb_onmousedown=void 0;this.removeEventListener("mouseup",l)},configurable:!0,enumerable:!0}),Object.defineProperty(n,"kb_addInputBoxBinding",
{value:function(){this.kb_onmousedown=!0;this.addEventListener("mouseup",l)},configurable:!0,enumerable:!0}));for(h=0;h<g.length;h+=1)void 0===k[c].descriptors[g[h]]&&e.injectPrototypeProperty(a,g[h],null,null,c);return e};e.injectStyle=function(a,f,b,h){var c=Object.getOwnPropertyDescriptor(a.style,f),d=a.style;void 0===a.style.kb_bind&&(a.style.kb_bind={obj:a,proto:d,descriptors:{},set:void 0,update:void 0});a.style.kb_bind.set=b?b:k[_injectName].set;a.style.kb_bind.update=h?h:k[_injectName].update;
a.style.kb_bind.descriptors[f]=c;void 0!==c.value&&c.configurable&&Object.defineProperty(d,f,{get:function(){return c.value},set:function(b){var d=c.value;"function"==typeof a.style.kb_bind.set&&a.style.kb_bind.set(a,f,b,d)&&(c.value=b,a.style.setProperty(f.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),b));"function"===typeof a.style.kb_bind.update&&a.style.kb_bind.update(a,f,b,d)},enumerable:!0,configurable:!0});return e};e.injectedPrototypes=function(){return k};e.addAttrListener=function(a,
f,b){if(this.toString()!==e.toString())return void 0===this.kb_attrListeners()[a]&&(this.kb_attrListeners()[a]=[]),b&&void 0===this.kb_childAttrListeners()[a]&&(this.kb_childAttrListeners()[a]=[]),"function"===typeof f&&(b?this.kb_childAttrListeners()[a].push(f):this.kb_attrListeners()[a].push(f)),this;void 0===l[a]&&(l[a]=[]);"function"===typeof f&&l[a].push(f);return e};e.addAttrUpdateListener=function(a,f,b){if(this.toString()!==e.toString())return void 0===this.kb_attrUpdateListeners()[a]&&(this.kb_attrUpdateListeners()[a]=
[]),b&&void 0===this.kb_childAttrUpdateListeners()[a]&&(this.kb_childAttrUpdateListeners()[a]=[]),"function"===typeof f&&(b?this.kb_childAttrUpdateListeners()[a].push(f):this.kb_attrUpdateListeners()[a].push(f)),this;void 0===r[a]&&(r[a]=[]);"function"===typeof f&&r[a].push(f);return e};e.getAttrListeners=function(){return this.toString()!==e.toString()?this.kb_attrListeners():l};e.getAttrUpdateListeners=function(){return this.toString()!==e.toString()?this.kb_attrUpdateListeners():r};e.removeAttrListener=
function(a,f){if(this.toString()!==e.toString()){if(void 0!==this.kb_attrListeners&&void 0!==this.kb_attrListeners()[a]&&"function"===typeof f){for(var b=0;b<this.kb_attrListeners()[a].length;b+=1)this.kb_attrListeners()[a][b].toString()===f.toString()&&this.kb_attrListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrListeners()[a])for(b=0;b<this.kb_childAttrListeners()[a].length;b+=1)this.kb_childAttrListeners()[a][b].toString()===f.toString()&&this.kb_childAttrListeners()[a].splice(b,1)}return this}if(void 0!==
l[a]&&"function"===typeof f)for(b=0;b<l[a].length;b+=1)l[a][b].toString()===f.toString()&&l[a].splice(b,1);return e};e.removeAttrUpdateListener=function(a,f){if(this.toString()!==e.toString()){if(void 0!==this.kb_attrUpdateListeners&&void 0!==this.kb_attrUpdateListeners()[a]&&"function"===typeof f){for(var b=0;b<this.kb_attrUpdateListeners()[a].length;b+=1)this.kb_attrUpdateListeners()[a][b].toString()===f.toString()&&this.kb_attrUpdateListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrUpdateListeners()[a])for(b=
0;b<this.kb_childAttrUpdateListeners()[a].length;b+=1)this.kb_childAttrUpdateListeners()[a][b].toString()===f.toString()&&this.kb_childAttrUpdateListeners()[a].splice(b,1)}return this}if(void 0!==r[a]&&"function"===typeof f)for(b=0;b<r[a].length;b+=1)r[a][b].toString()===f.toString()&&r[a].splice(b,1);return e};e.injectPrototypes(Node,p,q);e.injectPrototypes(Element,p,q);e.injectPrototypes(HTMLElement,p,q);e.injectPrototypes(HTMLInputElement,p,q);e.injectPrototypes(HTMLTextAreaElement,p,q);e.injectPrototypes(Document,
p,q);return e}"function"===typeof define&&define.amd?(define("KB",t),define([],function(){return t})):"object"===typeof module&&module.exports&&(module.exports=t);return t}();

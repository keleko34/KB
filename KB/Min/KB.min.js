var CreateKB=function(){function r(){function e(){function a(d){if("outerHTML"===d.attr||"outerText"===d.attr)d.target=d.target.parentElement;var a=0,a="appendChild"===d.attr&&"INPUT"===d.arguments[0].tagName?d.arguments[0]:[],b="appendChild"===d.attr&&"TEXTAREA"===d.arguments[0].tagName?d.arguments[0]:[],c=d.target.getElementsByTagName("INPUT"),b=Array.prototype.slice.call(c).concat(a).filter(function(a){return"radio"!==a.type&&"checkbox"!==a.type}).concat(Array.prototype.slice.call(d.target.getElementsByTagName("TEXTAREA")).concat(b)),
f=Array.prototype.slice.call(c).concat(a).filter(function(a){return"radio"===a.type||"checkbox"===a.type}),c=Object.getOwnPropertyNames(d.target.style);d=Array.prototype.slice.call(d.target.querySelectorAll("*")).concat("appendChild"===d.attr?[d.arguments[0]]:[]);for(a=0;a<b.length;a++)void 0===b[a].kb_onkeydown&&b[a].kb_addInputBinding();for(a=0;a<f.length;a++)void 0===f[a].kb_onmousedown&&f[a].kb_addInputBoxBinding();for(a=0;a<d.length;a++)for(b=0;b<c.length;b++)e.injectStyle(d[a],c[b],n,p)}function c(a){var b=
new t(a.target,a.arguments[0],"setAttribute"===a.attr?a.arguments[1]:"",a.target.getAttribute(a.arguments[0]),"setAttribute"===a.attr?[a.arguments[1]]:[""]);if(void 0!==k[b.attr])for(f=0;f<k[b.attr].length;f+=1)k[b.attr][f].call(b.target,b),b._stopPropogation&&a.stopPropagation(),b._preventDefault&&a.preventDefault()}function b(a){var b=new t(a.target,a.arguments[0],"setAttribute"===a.attr?a.arguments[1]:"",a.target.getAttribute(a.arguments[0]),"setAttribute"===a.attr?[a.arguments[1]]:[""]);if(void 0!==
l[b.attr])for(f=0;f<l[b.attr].length;f+=1)l[b.attr][f].call(b.target,b),b._stopPropogation&&a.stopPropagation()}var u=Object.keys(g);for(f=0;f<u.length;f++)void 0===g[u[f]].set&&e.injectPrototypes(g[u[f]].obj,n,p);e.addAttrUpdateListener("appendChild",a);e.addAttrUpdateListener("removeChild",a);e.addAttrUpdateListener("innerHTML",a);e.addAttrUpdateListener("outerHTML",a);e.addAttrUpdateListener("innerText",a);e.addAttrUpdateListener("outerText",a);e.addAttrUpdateListener("textContent",a);e.addAttrListener("setAttribute",
c);e.addAttrListener("removeAttribute",c);e.addAttrUpdateListener("setAttribute",b);e.addAttrUpdateListener("removeAttribute",b);(function(){for(var a=Object.getOwnPropertyNames(document.all[0].style),b=0;b<document.all.length;b++)for(var c=0;c<a.length;c++)e.injectStyle(document.all[b],a[c],n,p)})();(function(){for(var a=0,a=document.getElementsByTagName("INPUT"),b=Array.prototype.slice.call(a).filter(function(a){return"radio"!==a.type&&"checkbox"!==a.type}).concat(Array.prototype.slice.call(document.getElementsByTagName("TEXTAREA"))),
c=Array.prototype.slice.call(a).filter(function(a){return"radio"===a.type||"checkbox"===a.type}),a=0;a<b.length;a++)void 0===b[a].kb_onkeydown&&b[a].kb_addInputBinding();for(a=0;a<c.length;a++)void 0===c[a].kb_onmousedown&&c[a].kb_addInputBoxBinding()})()}function r(a,c){e.addAttrListener.call(this,a,c,!0)}function w(a,c){e.addAttrUpdateListener.call(this,a,c,!0)}var k={},l={},g={},f,q,v=function(a,c,b){for(var e=[];a;)(a=a.parentElement)&&void 0!==a[b?"kb_childAttrUpdateListeners":"kb_childAttrListeners"]()[c]&&
e.push(a);return e},t=function(a,c,b,e,d,f){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};this.value=b;this.oldValue=e;this.target=a;this.attr=c;this.arguments=d;this.action=f;this.child=void 0},n=function(a,c,b,e,d){b=new t(a,c,b,e,d);e=v(a,c);if(void 0!==k["*"])a:for(f=0;f<k["*"].length;f+=1)if(k["*"][f].call(a,b),b._stopPropogation)break a;if(void 0!==k[c]&&!b._stopPropogation)a:for(f=0;f<k[c].length;f+=1)if(k[c][f].call(a,b),
b._stopPropogation)break a;if(void 0!==a.kb_attrListeners&&void 0!==a.kb_attrListeners()[c]&&!b._stopPropogation)a:for(f=0;f<a.kb_attrListeners()[c].length;f+=1)if(a.kb_attrListeners()[c][f].call(a,b),b._stopPropogation)break a;if(0<e.length)for(f=0;f<e.length;f++)b:for(q=0;q<e[f].kb_childAttrListeners()[c].length;q++)if(b.child=a,b.target=e[f],e[f].kb_childAttrListeners()[c][q].call(e[f],b),b._stopPropogation)break b;return b._preventDefault?!1:!0},p=function(a,c,b,e,d,f){b=new t(a,c,b,e,d,f);e=
v(a,c,!0);if(void 0!==l["*"])a:for(d=0;d<l["*"].length;d+=1)if(l["*"][d].call(a,b),b._stopPropogation)break a;if(void 0!==l[c])a:for(d=0;d<l[c].length;d+=1)if(l[c][d].call(a,b),b._stopPropogation)break a;if(void 0!==a.kb_attrUpdateListeners&&void 0!==a.kb_attrUpdateListeners[c])a:for(d=0;d<a.kb_attrUpdateListeners[c].length;d+=1)if(a.kb_attrUpdateListeners[c][d].call(a,b),b._stopPropogation)break a;if(0<e.length)for(d=0;d<e.length;d++)b:for(q=0;q<e[d].kb_childAttrUpdateListeners()[c].length;q++)if(b.child=
a,b.target=e[d],e[d].kb_childAttrUpdateListeners()[c][q].call(parent[d],b),b._stopPropogation)break b;return b._preventDefault?!1:!0};e.injectPrototypeProperty=function(a,c,b,f,d){var h=a.prototype,m=Object.getOwnPropertyDescriptor(h,c);d=d||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");void 0===h.addAttrListener&&void 0===h.kb_attrListeners&&(h.kb_attrListeners=function(){void 0===this._kb_attrListeners&&(this._kb_attrListeners={});return this._kb_attrListeners},h.addAttrListener=e.addAttrListener,
h.removeAttrListener=e.removeAttrListener);h.hasOwnProperty("children")&&void 0===h.addChildAttrListener&&void 0===h.kb_childAttrListeners&&(h.kb_childAttrListeners=function(){void 0===this._kb_childAttrListeners&&(this._kb_childAttrListeners={});return this._kb_childAttrListeners},h.addChildAttrListener=r,h.getchildAttrListeners=function(){return this.kb_childAttrListeners()});void 0===h.addAttrUpdateListener&&void 0===h.kb_attrUpdateListeners&&(h.kb_attrUpdateListeners=function(){void 0===this._kb_attrUpdateListeners&&
(this._kb_attrUpdateListeners={});return this._kb_attrUpdateListeners},h.addAttrUpdateListener=e.addAttrUpdateListener,h.removeAttrUpdateListener=e.removeAttrUpdateListener);h.hasOwnProperty("children")&&void 0===h.addChildAttrUpdateListener&&void 0===h.kb_childAttrUpdateListeners&&(h.kb_childAttrUpdateListeners=function(){void 0===this._kb_childAttrUpdateListeners&&(this._kb_childAttrUpdateListeners={});return this._kb_childAttrUpdateListeners},h.addChildAttrUpdateListener=w,h.getchildAttrUpdateListeners=
function(){return this.kb_childAttrUpdateListeners()});void 0===g[d]&&(g[d]={obj:a,proto:h,descriptors:{},set:void 0,update:void 0});g[d].set=b?b:g[d].set;g[d].update=f?f:g[d].update;g[d].descriptors[c]=m;void 0!==m.set&&m.configurable?Object.defineProperty(h,c,{get:m.get,set:function(a){var b=m.get.apply(this);"function"==typeof g[d].set&&g[d].set(this,c,a,b,arguments)&&m.set.apply(this,arguments);"function"===typeof g[d].update&&g[d].update(this,c,a,b)},enumerable:!0,configurable:!0}):"function"===
typeof m.value?Object.defineProperty(h,c,{value:function(){var a=null;"function"==typeof g[d].set&&g[d].set(this,c,null,null,arguments)&&(a=m.value.apply(this,arguments));"function"===typeof g[d].update&&g[d].update(this,c,null,null,arguments,a);return a},writable:!0,enumerable:!0,configurable:!0}):void 0!==m.value&&m.configurable&&Object.defineProperty(h,c,{get:function(){return m.value},set:function(a){var b=m.value;"function"==typeof g[d].set&&g[d].set(this,c,a,b)&&(m.value=a);"function"===typeof g[d].update&&
g[d].update(this,c,a,b)},enumerable:!0,configurable:!0})};e.injectPrototypes=function(a,c,b){var k=a.prototype,d=a.toString().split(/\s+/)[1].split("{")[0].replace("()",""),h=Object.getOwnPropertyNames(k),m={},l=function(a){var b=!1,c="false";if("checkbox"===this.type||"radio"===this.type)c=this.checked,b=!0;var e=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;setTimeout(function(){b&&!g[d].set(this,"checked",this.checked,c)?m.checked.set.call(this,
c):b&&"function"===typeof g[d].update&&g[d].update(this,"checked",this.checked,e);this.value=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;g[d].set(this,"value",this.value,e)?"function"===typeof g[d].update&&g[d].update(this,"value",this.value,e):m.value.set.call(this,e)}.bind(this),0)};void 0===g[d]&&(g[d]={obj:a,proto:k,descriptors:{},set:void 0,update:void 0});g[d].set=c||n;g[d].update=b||p;-1<h.indexOf("value")&&(Object.defineProperty(k,"kb_removeInputBinding",
{value:function(){this.kb_onkeydown=void 0;this.removeEventListener("keydown",l)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_addInputBinding",{value:function(){this.kb_onkeydown=!0;this.addEventListener("keydown",l)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_removeInputBoxBinding",{value:function(){this.kb_onmousedown=void 0;this.removeEventListener("mouseup",l)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_addInputBoxBinding",{value:function(){this.kb_onmousedown=
!0;this.addEventListener("mouseup",l)},configurable:!0,enumerable:!0}));for(f=0;f<h.length;f+=1)void 0===g[d].descriptors[h[f]]&&e.injectPrototypeProperty(a,h[f],null,null,d);return e};e.injectStyle=function(a,c,b,f){var d=Object.getOwnPropertyDescriptor(a.style,c),h=a.style;void 0===a.style.kb_bind&&(a.style.kb_bind={obj:a,proto:h,descriptors:{},set:void 0,update:void 0});a.style.kb_bind.set=b?b:g[_injectName].set;a.style.kb_bind.update=f?f:g[_injectName].update;a.style.kb_bind.descriptors[c]=d;
void 0!==d.value&&d.configurable&&Object.defineProperty(h,c,{get:function(){return d.value},set:function(b){var e=d.value;"function"==typeof a.style.kb_bind.set&&a.style.kb_bind.set(a,c,b,e)&&(d.value=b,a.style.setProperty(c.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),b));"function"===typeof a.style.kb_bind.update&&a.style.kb_bind.update(a,c,b,e)},enumerable:!0,configurable:!0});return e};e.injectedPrototypes=function(){return g};e.addAttrListener=function(a,c,b){if(this.toString()!==e.toString())return void 0===
this.kb_attrListeners()[a]&&(this.kb_attrListeners()[a]=[]),b&&void 0===this.kb_childAttrListeners()[a]&&(this.kb_childAttrListeners()[a]=[]),"function"===typeof c&&(b?this.kb_childAttrListeners()[a].push(c):this.kb_attrListeners()[a].push(c)),this;void 0===k[a]&&(k[a]=[]);"function"===typeof c&&k[a].push(c);return e};e.addAttrUpdateListener=function(a,c,b){if(this.toString()!==e.toString())return void 0===this.kb_attrUpdateListeners()[a]&&(this.kb_attrUpdateListeners()[a]=[]),b&&void 0===this.kb_childAttrUpdateListeners()[a]&&
(this.kb_childAttrUpdateListeners()[a]=[]),"function"===typeof c&&(b?this.kb_childAttrUpdateListeners()[a].push(c):this.kb_attrUpdateListeners()[a].push(c)),this;void 0===l[a]&&(l[a]=[]);"function"===typeof c&&l[a].push(c);return e};e.getAttrListeners=function(){return this.toString()!==e.toString()?this.kb_attrListeners():k};e.getAttrUpdateListeners=function(){return this.toString()!==e.toString()?this.kb_attrUpdateListeners():l};e.removeAttrListener=function(a,c){if(this.toString()!==e.toString()){if(void 0!==
this.kb_attrListeners&&void 0!==this.kb_attrListeners()[a]&&"function"===typeof c){for(var b=0;b<this.kb_attrListeners()[a].length;b+=1)this.kb_attrListeners()[a][b].toString()===c.toString()&&this.kb_attrListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrListeners()[a])for(b=0;b<this.kb_childAttrListeners()[a].length;b+=1)this.kb_childAttrListeners()[a][b].toString()===c.toString()&&this.kb_childAttrListeners()[a].splice(b,1)}return this}if(void 0!==k[a]&&"function"===typeof c)for(b=0;b<k[a].length;b+=
1)k[a][b].toString()===c.toString()&&k[a].splice(b,1);return e};e.removeAttrUpdateListener=function(a,c){if(this.toString()!==e.toString()){if(void 0!==this.kb_attrUpdateListeners&&void 0!==this.kb_attrUpdateListeners()[a]&&"function"===typeof c){for(var b=0;b<this.kb_attrUpdateListeners()[a].length;b+=1)this.kb_attrUpdateListeners()[a][b].toString()===c.toString()&&this.kb_attrUpdateListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrUpdateListeners()[a])for(b=0;b<this.kb_childAttrUpdateListeners()[a].length;b+=
1)this.kb_childAttrUpdateListeners()[a][b].toString()===c.toString()&&this.kb_childAttrUpdateListeners()[a].splice(b,1)}return this}if(void 0!==l[a]&&"function"===typeof c)for(b=0;b<l[a].length;b+=1)l[a][b].toString()===c.toString()&&l[a].splice(b,1);return e};e.injectPrototypes(Node,n,p);e.injectPrototypes(Element,n,p);e.injectPrototypes(HTMLElement,n,p);e.injectPrototypes(HTMLInputElement,n,p);e.injectPrototypes(HTMLTextAreaElement,n,p);e.injectPrototypes(Document,n,p);return e}"function"===typeof define&&
define.amd?(define("KB",r),define([],function(){return r})):"object"===typeof module&&module.exports&&(module.exports=r);return r}();

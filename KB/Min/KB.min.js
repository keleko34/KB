var KB=function(){var E=function(){function E(){function k(b,c){var a=b.length,e;for(e=0;e<a&&(b[e](c),void 0===c._stopPropogation);e++);}function r(b,c){var a=b.length,e;for(e=0;e<a&&(c.child=c.target,c.target=b[e].parent,b[e].func(c),void 0===c._stopPropogation);e++);}function J(b,c){for(var a=b.length;0<a;K++)if(b[K].toString()===c.toString())return!0;return!1}function L(b,c,a,e,f,d,g,h){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=
!0};this.value=a;this.oldValue=e;this.target=b;this.attr=c;this.arguments=f;this.action=d;this.child=void 0;this.type=g;this.stopChange=h}function M(){this._attrListeners={};this._attrUpdateListeners={};this._styleListeners={};this._styleUpdateListeners={};this._parentStyleListeners={};this._parentStyleUpdateListeners={};this._parentAttrListeners={};this._parentAttrUpdateListeners={};this._injectedStyle={}}function P(b,c,a,e){var f=b.get,d=b.set,g;return function(b,h){g=f.call(this);a(this,c,b,g,
void 0,h)&&d.call(this,b);h||e(this,c,b,g)}}function Q(b,c,a,e){var f;return function(d,g){f=b.value;a(this,c,d,f,arguments,g)&&(b.value=d);g||e(this,c,d,f,arguments)}}function R(b,c,a,e){var f=b.value,d;return function(){a(this,c,null,null,arguments)&&(d=f.apply(this,arguments));e(this,c,null,null,arguments,d);return d}}function S(b,c,a,e,f){var d=f.style,g=c.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),h,m;return{get:function(){return m},set:function(b,n){h=m;a(f,c,b,h,void 0,n)&&(m=b,
d.setProperty(g,b));n||e(f,c,b,h)},enumerable:!0,configurable:!0}}function G(b,c,a,e){if("function"!==typeof c)return h;var f=-1!==["value","checked"].indexOf(b),d=-1!==w.indexOf(b),g;if(this.toString()!==h.toString())if(a){var u=this.querySelectorAll("*");a=u.length;for(var m,l=0;l<a;l++){m=u[l].attrListeners();if(f||"*"===b)void 0!==u[l].addInputBinding&&u[l].addInputBinding(),void 0!==u[l].addInputBoxBinding&&u[l].addInputBoxBinding();if(d)h.injectStyleProperty(u[l],b),g=e?"_parentStyleUpdateListeners":
"_parentStyleListeners";else{if("*"===b){g=e?"_parentStyleUpdateListeners":"_parentStyleListeners";a=w.length;for(var n=0;n<a;n++)h.injectStyleProperty(u[l],w[n]);void 0===m[g]["*"]&&(m[g]["*"]=[]);m[g]["*"].push({parent:this,func:c})}g=e?"_parentAttrUpdateListeners":"_parentAttrListeners"}void 0===m[g][b]&&(m[g][b]=[]);m[g][b].push({parent:this,func:c})}}else{m=this.attrListeners();if(d)g=e?"_styleUpdateListeners":"_styleListeners",h.injectStyleProperty(this,b);else{if(f||"*"===b)void 0!==this.addInputBinding&&
this.addInputBinding(),void 0!==this.addInputBoxBinding&&this.addInputBoxBinding();if("*"===b){g=e?"_styleUpdateListeners":"_styleListeners";a=w.length;for(l=0;l<a;l++)h.injectStyleProperty(this,w[l]);void 0===m[g][b]&&(m[g][b]=[]);m[g][b].push(c)}g=e?"_attrUpdateListeners":"_attrListeners"}void 0===m[g][b]&&(m[g][b]=[]);m[g][b].push(c)}else{if(f||"*"===b)for(n=document.querySelectorAll("input, textarea"),a=n.length,l=0;l<a;l++)void 0!==n[l].addInputBinding&&n[l].addInputBinding(),void 0!==n[l].addInputBoxBinding&&
n[l].addInputBoxBinding();if(d){d=Array.prototype.slice.call(document.body.querySelectorAll("*"));a=d.length+1;d.unshift(document.body);for(l=0;l<a;l++)h.injectStyleProperty(d[l],b);g=e?B:C}else{if("*"===b){d=Array.prototype.slice.call(document.body.querySelectorAll("*"));a=d.length+1;f=w.length;d.unshift(document.body);for(l=0;l<a;l++)for(n=0;n<f;n++)h.injectStyleProperty(d[l],w[n]);g=e?B:C;void 0===g[b]&&(g[b]=[]);g[b].push(c)}g=e?x:y}void 0===g[b]&&(g[b]=[]);g[b].push(c)}}function H(b,c,a,e){function f(b,
a){var d=a[b],e=d.length;for(g=0;g<e;g++)d[g].toString()===c.toString()&&d.splice(g,1)}if("function"!==typeof c)return h;["value","checked"].indexOf(b);var d=-1!==w.indexOf(b),g;if(this.toString()!==h.toString())if(a){a=this.querySelectorAll("*");var u=a.length;d?(d=e?"_childStyleUpdateListeners":"_childStyleListeners",f(b,this.attrListeners()[d]),d=e?"_parentStyleUpdateListeners":"_parentStyleListeners"):("*"===b&&(d=e?"_childStyleUpdateListeners":"_childStyleListeners",f(b,this.attrListeners()[d])),
d=e?"_childAttrUpdateListeners":"_childAttrListeners",f(b,this.attrListeners()[d]),d=e?"_parentAttrUpdateListeners":"_parentAttrListeners");for(g=0;g<u;g++){for(var m=a[g].attrListeners()[d][b],l=m.length,n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1);if("*"===b)for(listenersStyle=e?"_parentStyleUpdateListeners":"_parentStyleListeners",m=a[g].attrListeners()[d][b],l=m.length,n=0;n<l;n++)m[n].isEqualNode(this)&&m.slice(n,1)}}else d?d=e?"_styleUpdateListeners":"_styleListeners":("*"===b&&(d=e?"_styleUpdateListeners":
"_styleListeners",f(b,this.attrListeners()[d])),d=e?"_attrUpdateListeners":"_attrListeners"),f(b,this.attrListeners()[d]);else d?d=e?B:C:("*"===b&&(d=e?B:C,f(b,d)),d=e?x:y),f(b,d)}function N(b,c){h.addAttrListener.call(this,b,c,!0);return this}function O(b,c){h.addAttrUpdateListener.call(this,b,c,!0);return this}function T(b,c){h.removeAttrListener.call(this,b,c,!0);return this}function U(b,c){h.removeAttrUpdateListener.call(this,b,c,!0);return this}function h(){function b(b,a){var c,d=a.length;for(c=
0;c<d;c++)-1===b.indexOf(a[c])&&b.push(a[c]);return b}function c(a){if(3!==a.target.nodeType&&8!==a.target.nodeType){var c=a.target.attrListeners(),d,e=["value","checked"],f=c._attrListeners,z=c._attrUpdateListeners,p=c._parentAttrListeners;d=c._parentAttrUpdateListeners;var k=!1;if(void 0!==y["*"]||void 0!==x["*"])k=!0;if(!0!==k&&void 0!==f["*"]||void 0!==z["*"]||void 0!==p["*"]||void 0!==d["*"])k=!0;if(!0!==k)for(var v=0;v<e.length;v++)if(void 0!==y[e[v]]||void 0!==x[e[v]]||void 0!==f[e[v]]||void 0!==
z[e[v]]||void 0!==p[e[v]]||void 0!==d[e[v]]){k=!0;break}d=k;e=Object.keys(C);f=Object.keys(B);Object.keys(c._styleListeners);Object.keys(c._styleUpdateListeners);z=Object.keys(c._parentStyleListeners);c=Object.keys(c._parentStyleUpdateListeners);p=[];if(0!==e.length||0!==f.length)p=b(p,e),p=b(p,f);if(0!==p.length&&0!==z.length||0!==c.length)p=b(p,z),p=b(p,c);-1!==p.indexOf("*")&&(p=w);var c=p,e=c.length,r,A,f=[],q,z="outerHTML"===a.attr||"outerText"===a.attr?a.attr:void 0,p=a.target;void 0!==z&&(a.attr=
"appendChild",a.arguments=[a.target],a.target=a.target.parentElement);if(d){"appendChild"===a.attr&&3!==a.arguments[0].nodeType&&8!==a.arguments[0].nodeType?(f=Array.prototype.slice.call(a.arguments[0].querySelectorAll("input,textarea")),"INPUT"!==a.arguments[0].tagName&&"TEXTAREA"!==a.arguments[0].tagName||f.unshift(a.arguments[0])):f=Array.prototype.slice.call(a.target.querySelectorAll("input,textarea"));q=f.length;for(var t=0;t<q;t++)void 0!==f[t].addInputBinding&&f[t].addInputBinding(),void 0!==
f[t].addInputBoxBinding&&f[t].addInputBoxBinding()}"appendChild"===a.attr&&"#text"!==a.arguments[0].nodeName&&"#comment"!==a.arguments[0].nodeName?(f=Array.prototype.slice.call(a.arguments[0].querySelectorAll("*")),f.unshift(a.arguments[0])):f=Array.prototype.slice.call(a.target.querySelectorAll("*"));d=a.target.__kb._parentAttrListeners;k=a.target.__kb._parentAttrUpdateListeners;v=a.target.__kb._parentStyleListeners;r=a.target.__kb._parentStyleUpdateListeners;q=f.length;for(t=0;t<q;t++){if(0!==e)for(A=
0;A<e;A++)h.injectStyleProperty(f[t],c[A]);A=f[t].attrListeners();A._parentAttrListeners=d;A._parentAttrUpdateListeners=k;A._parentStyleListeners=v;A._parentStyleUpdateListeners=r}void 0!==z&&(a.attr=z,a.target=p,a.arguments=[])}}function a(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";f(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])||a.preventDefault()}function e(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:
"";d(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])}h.injectPrototypes(Node,"Node");h.injectPrototypes(Element,"Element");h.injectPrototypes(HTMLElement,"HTMLElement");h.injectPrototypes(HTMLInputElement,"HTMLInputElement");h.injectPrototypes(HTMLTextAreaElement,"HTMLTextAreaElement");h.injectPrototypes(Document,"Document");var f=I,d=F;h.addAttrUpdateListener("appendChild",c);h.addAttrUpdateListener("removeChild",c);h.addAttrUpdateListener("innerHTML",c);h.addAttrUpdateListener("outerHTML",
c);h.addAttrUpdateListener("innerText",c);h.addAttrUpdateListener("outerText",c);h.addAttrUpdateListener("textContent",c);h.addAttrListener("setAttribute",a);h.addAttrListener("removeAttribute",a);h.addAttrUpdateListener("setAttribute",e);h.addAttrUpdateListener("removeAttribute",e);return h}var y={},x={},C={},B={},q={},D="textContent innerHTML innerText outerHTML outerText appendChild removeChild replaceChild insertAdjacentHTML insertBefore".split(" "),w=Object.getOwnPropertyNames(document.body.style),
K,I=function(b,c,a,e,f,d){a=new L(b,c,a,e,f,void 0,"set",d);void 0!==b.__kb&&(e=b.__kb._attrListeners,f=b.__kb._styleListeners,d=b.__kb._parentAttrListeners,b=b.__kb._parentStyleListeners,void 0!==e[c]&&k(e[c],a),void 0===a._stopPropogation&&void 0!==f[c]&&k(f[c],a),void 0===a._stopPropogation&&void 0!==e["*"]&&(k(e["*"],a),void 0===a._stopPropogation&&k(f["*"],a)),void 0===a._stopPropogation&&void 0!==d[c]&&r(d[c],a),void 0===a._stopPropogation&&void 0!==b[c]&&r(b[c],a),void 0===a._stopPropogation&&
void 0!==d["*"]&&(r(d["*"],a),void 0===a._stopPropogation&&r(b["*"],a)));void 0===a._stopPropogation&&void 0!==y[c]&&k(y[c],a);void 0===a._stopPropogation&&void 0!==C[c]&&k(C[c],a);void 0===a._stopPropogation&&void 0!==y["*"]&&(k(y["*"],a),void 0===a._stopPropogation&&k(C["*"],a));return void 0!==a._preventDefault?!1:!0},F=function(b,c,a,e,f,d){a=new L(b,c,a,e,f,d,"update");void 0!==b.__kb&&(e=b.__kb._attrUpdateListeners,f=b.__kb._styleUpdateListeners,d=b.__kb._parentAttrUpdateListeners,b=b.__kb._parentStyleUpdateListeners,
void 0!==e[c]&&k(e[c],a),void 0===a._stopPropogation&&void 0!==f[c]&&k(f[c],a),void 0===a._stopPropogation&&void 0!==e["*"]&&(k(e["*"],a),void 0===a._stopPropogation&&k(f["*"],a)),void 0===a._stopPropogation&&void 0!==d[c]&&r(d[c],a),void 0===a._stopPropogation&&void 0!==b[c]&&r(b[c],a),void 0===a._stopPropogation&&void 0!==d["*"]&&(r(d["*"],a),void 0===a._stopPropogation&&r(b["*"],a)));void 0===a._stopPropogation&&void 0!==x[c]&&k(x[c],a);void 0===a._stopPropogation&&void 0!==B[c]&&k(B[c],a);void 0===
a._stopPropogation&&void 0!==x["*"]&&(k(x["*"],a),void 0===a._stopPropogation&&k(B["*"],a));return void 0!==a._preventDefault?!1:!0};h.injectPrototypeProperty=function(b,c,a,e,f){var d=b.prototype,g=Object.getOwnPropertyDescriptor(d,c);a=a||b.toString().split(/\s+/)[1].split("{")[0].replace("()","");var k=q[a];e=e||I;f=f||F;void 0===d.attrListeners&&(d={},d.attrListeners=function(){void 0===this.__kb&&(this.__kb=new M);return this.__kb}.bind(d),d.addAttrListener=h.addAttrListener,d.addAttrUpdateListener=
h.addAttrUpdateListener,d.addChildAttrListener=N,d.addChildAttrUpdateListener=O,d.removeAttrListener=h.removeAttrListener,d.removeAttrUpdateListener=h.removeAttrUpdateListener,d.removeChildAttrListener=T,d.removeChildAttrUpdateListener=U);void 0===k&&(q[a]={obj:b,proto:d,descriptors:{},set:void 0,update:void 0},k=q[a],k.set=e,k.update=f);void 0===k.descriptors[c]&&(k.descriptors[c]=g);g.configurable&&(void 0!==g.set?Object.defineProperty(d,c,{get:g.get,set:P(g,c,e,f),enumerable:!0,configurable:!0}):
"function"===typeof g.value?Object.defineProperty(d,c,{value:R(g,c,e,f),writable:!0,enumerable:!0,configurable:!0}):void 0!==g.value&&Object.defineProperty(d,c,{get:function(){return g.value},set:Q(g,c,e,f),enumerable:!0,configurable:!0}));return h};h.injectStyleProperty=function(b,c,a,e){var f=b.style,d=Object.getOwnPropertyDescriptor(f,c),g=b.attrListeners().injectedStyle;a=a||I;e=e||F;void 0===g&&(b.attrListeners().injectedStyle={obj:b,proto:f,descriptors:{},set:void 0,update:void 0},b.attrListeners().injectedStyle.set=
a,b.attrListeners().injectedStyle.update=e,g=b.attrListeners().injectedStyle);void 0===g.descriptors[c]&&(g.descriptors[c]=d);d.configurable&&Object.defineProperty(f,c,S(d,c,a,e,b));return h};h.injectPrototypes=function(b,c,a,e){var f=b.prototype;c=c||b.toString().split(/\s+/)[1].split("{")[0].replace("()","");var d=q[c],g=Object.getOwnPropertyNames(f);a=a||I;e=e||F;var k;void 0===f.attrListeners&&(f.attrListeners=function(){void 0===this.__kb&&(this.__kb=new M);return this.__kb},f.addAttrListener=
h.addAttrListener,f.addAttrUpdateListener=h.addAttrUpdateListener,f.addChildAttrListener=N,f.addChildAttrUpdateListener=O);void 0===d&&(q[c]={obj:b,proto:f,descriptors:{},set:void 0,update:void 0},d=q[c],d.set=a,d.update=e);k=q[c].descriptors;for(e=0;e<g.length;e+=1)void 0===k[g[e]]&&h.injectPrototypeProperty(b,g[e],c,a,F);if(-1!==g.indexOf("value")){var m=function(a){var b,c,e;if("checkbox"===this.type||"radio"===this.type)b=!0;c=b?"string"===typeof this.checked?this.checked:this.checked?"true":
"false":this.value;setTimeout(function(){e=b?"string"===typeof this.checked?this.checked:this.checked?"true":"false":this.value;b&&(d.set(this,"checked",this.checked,c)?d.update(this,"checked",this.checked,c):k.checked.set.call(this,c));this.value=e;d.set(this,"value",this.value,c)?d.update(this,"value",this.checked,c):k.value.set.call(this,c)}.bind(this),0)};f.removeInputBinding=function(){this.attrListeners()._onkeydown=void 0;this.removeEventListener("keydown",m)};f.addInputBinding=function(){this.attrListeners()._onkeydown=
!0;this.addEventListener("keydown",m)};f.removeInputBoxBinding=function(){this.attrListeners()._onmousedown=void 0;this.removeEventListener("mouseup",m)};f.addInputBoxBinding=function(){this.attrListeners()._onmousedown=!0;this.addEventListener("mouseup",m)}}return h};h.addAttrListener=function(b,c,a){if("html"===b){b=0;for(var e=D.length;b<e;b++)G.call(this,D[b],c,a,!1)}else G.call(this,b,c,a,!1);return h};h.addAttrUpdateListener=function(b,c,a){if("html"===b){b=0;for(var e=D.length;b<e;b++)G.call(this,
D[b],c,a,!0)}else G.call(this,b,c,a,!0);return h};h.removeAttrListener=function(b,c,a){if("html"===b){b=0;for(var e=D.length;b<e;b++)H.call(this,D[b],c,a,!1)}else H.call(this,b,c,a,!1);return h};h.removeAttrUpdateListener=function(b,c,a){if("html"===b){b=0;for(var e=D.length;b<e;b++)H.call(this,D[b],c,a,!0)}else H.call(this,b,c,a,!0);return h};h.hasListener=function(b,c,a){"html"===c&&(c="innerHTML");switch(b){case "attr":if(J(y[c],a))return!0;break;case "attrupdate":if(J(x[c],a))return!0}return!1};
h.injectedPrototypes=function(){return q};return h}"function"===typeof define&&define.amd&&define("KB",E);return E}();window.define&&window.require?define([],function(){return E}):window.module&&(module.exports=E);return E}();

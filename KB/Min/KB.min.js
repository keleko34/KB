var CreateKB=function(){function u(){function e(){function a(a){var d=a.arguments[0];if("appendChild"!==a.attr||"SCRIPT"!==d.tagName&&"LINK"!==d.tagName&&"#text"!==d.nodeName&&"#comment"!==d.nodeName){if("outerHTML"===a.attr||"outerText"===a.attr)a.target=a.target.parentElement;var c=0,c=a.target,e="appendChild"!==a.attr?c.getElementsByTagName("INPUT"):a.arguments[0].getElementsByTagName("INPUT"),d="appendChild"!==a.attr?c.getElementsByTagName("TEXTAREA"):a.arguments[0].getElementsByTagName("TEXTAREA"),
d=f(e,d,a),e=b(e,a),h=[],c="appendChild"!==a.attr?c.querySelectorAll("*"):a.arguments[0].querySelectorAll("*"),g=c.length,v,k=0;for(v=0;v<g;v++)3!==c[v].nodeType&&8!==c[v].nodeType&&(h[k]=c[v],k++);"appendChild"===a.attr&&(c=a.arguments[0].nodeType,3!==c&&8!==c&&(h[h.length]=a.arguments[0]));for(c=0;c<d.length;c++)d[c].kb_addInputBinding();for(c=0;c<e.length;c++)e[c].kb_addInputBoxBinding();void 0!==l["*"]&&0<l["*"].length||void 0!==p["*"]&&0<p["*"].length?w("*",h):x&&(B(h),C(h))}else a.stopPropagation()}
function f(a,b,c){var f=a.length,d=b.length,e=[],h,g=0;for(h=0;h<f;h++){var k=a[h].type;"radio"!==k&&"checkbox"!==k&&void 0===a[h].kb_onkeydown&&void 0===a[h].kb_onmousedown&&(e[g]=a[h],g++)}for(h=0;h<d;h++)e[g]=b[h],g++;"appendChild"===c.attr&&(a=c.arguments[0],b=a.tagName,"INPUT"===b&&"checkbox"!==a.type&&"radio"!==a.type||"TEXTAREA"===b)&&(e[e.length]=a);return e}function b(a,b){var c=a.length,f=[],d,e=0;for(d=0;d<c;d++){var h=a[d].type;if("radio"===h||"checkbox"===h&&void 0===a[d].kb_onkeydown&&
void 0===a[d].kb_onmousedown)f[e]=a[d],e++}"appendChild"===b.attr&&(c=b.arguments[0],"INPUT"===c.tagName&&"checkbox"===c.type&&"radio"===c.type&&(f[f.length]=c));return f}function h(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";q(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])||a.preventDefault()}function c(a){var b=a.target.attributes[a.arguments[0]],c="setAttribute"===a.attr?a.arguments[1]:"";r(a.target,a.arguments[0],c,void 0!==b?b.value:"",[c])}
var d=Object.keys(k);for(g=0;g<d.length;g++)void 0===k[d[g]].set&&e.injectPrototypes(k[d[g]].obj,q,r);e.addAttrUpdateListener("appendChild",a);e.addAttrUpdateListener("removeChild",a);e.addAttrUpdateListener("innerHTML",a);e.addAttrUpdateListener("outerHTML",a);e.addAttrUpdateListener("innerText",a);e.addAttrUpdateListener("outerText",a);e.addAttrUpdateListener("textContent",a);e.addAttrListener("setAttribute",h);e.addAttrListener("removeAttribute",h);e.addAttrUpdateListener("setAttribute",c);e.addAttrUpdateListener("removeAttribute",
c);(function(){for(var a=0,a=document.getElementsByTagName("INPUT"),c=document.getElementsByTagName("TEXTAREA"),d={attr:"initial"},c=f(a,c,d),d=b(a,d),a=0;a<c.length;a++)c[a].kb_addInputBinding();for(a=0;a<d.length;a++)d[a].kb_addInputBoxBinding()})()}function u(a,f){e.addAttrListener.call(this,a,f,!0)}function D(a,f){e.addAttrUpdateListener.call(this,a,f,!0)}var l={},p={},k={},t=Object.getOwnPropertyNames(document.body.style),g,y,x=!1,w=function(a,f){void 0===f&&(f=Array.prototype.slice.call(document.body.querySelectorAll("*")),
f.unshift(document.body));var b,h=f.length;if("*"===a){var c=t.length,d;for(b=0;b<h;b++)for(d=0;d<c;d++)e.injectStyle(f[b],t[d],q,r)}else for(b=0;b<h;b++)e.injectStyle(f[b],a,q,r)},z=function(a,f,b,e){b=b?"kb_childAttrUpdateListeners":"kb_childAttrListeners";var c,d;e.child=a;a:for(;null!==a&&void 0!==a;)if(a=a.parentElement,null!==a&&void 0!==a&&(c=a[b]()[f],void 0!==c))for(d=c.length,y=0;y<d;y++)if(e.target=a,c[y].call(a,e),void 0!==e._stopPropogation)break a},A=function(a,f,b,e,c,d,m){this.stopPropagation=
function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};this.value=b;this.oldValue=e;this.target=a;this.attr=f;this.arguments=c;this.action=d;this.child=void 0;this.type=m},q=function(a,f,b,e,c){b=new A(a,f,b,e,c,"set");var d=l["*"],m;c=l[f];e=void 0!==a.kb_attrListeners?a.kb_attrListeners()[f]:void 0;if(void 0!==d)a:for(m=d.length,g=0;g<m;g+=1)if(d[g].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==c&&void 0===b._stopPropogation)a:for(d=c.length,g=0;g<
d;g+=1)if(c[g].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==e&&void 0===b._stopPropogation)a:for(c=e.length,g=0;g<c;g+=1)if(e[g].call(a,b),void 0!==b._stopPropogation)break a;z(a,f,!1,b);return void 0!==b._preventDefault?!1:!0},r=function(a,f,b,e,c,d){b=new A(a,f,b,e,c,d,"update");var m=p["*"],g;d=p[f];e=void 0!==a.kb_attrUpdateListeners?a.kb_attrUpdateListeners()[f]:void 0;if(void 0!==m)a:for(g=m.length,c=0;c<g;c+=1)if(m[c].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==d&&
void 0===b._stopPropogation)a:for(m=d.length,c=0;c<m;c+=1)if(d[c].call(a,b),void 0!==b._stopPropogation)break a;if(void 0!==e&&void 0===b._stopPropogation)a:for(d=e.length,c=0;c<d;c+=1)if(e[c].call(a,b),void 0!==b._stopPropogation)break a;z(a,f,!0,b);return void 0!==b._preventDefault?!1:!0},B=function(a){var f=Object.keys(l).filter(function(a){return-1!==t.indexOf(a)}).concat(Object.keys(p).filter(function(a){return-1!==t.indexOf(a)})),b,h=a.length,c,d=f.length;for(c=0;c<d;c++)for(b=0;b<h;b++)e.injectStyle(a[b],
f[c],q,r)},C=function(a){var f=function(a){var b=[];for(;null!==a&&void 0!==a;)a=a.parentElement,null!==a&&void 0!==a&&b.concat(Object.keys(a.kb_childAttrListeners()).filter(function(a){return-1!==t.indexOf(a)})).concat(Object.keys(a.kb_childAttrUpdateListeners()).filter(function(a){return-1!==t.indexOf(a)}));return b}(a[0]),b,h=a.length,c,d=f.length;for(c=0;c<d;c++)for(b=0;b<h;b++)e.injectStyle(a[b],f[c],q,r)};e.injectPrototypeProperty=function(a,f,b,h,c){var d=a.prototype,g=Object.getOwnPropertyDescriptor(d,
f);c=c||a.toString().split(/\s+/)[1].split("{")[0].replace("()","");var n=k[c];void 0===d.addAttrListener&&void 0===d.kb_attrListeners&&(d.kb_attrListeners=function(){void 0===this._kb_attrListeners&&(this._kb_attrListeners={});return this._kb_attrListeners},d.addAttrListener=e.addAttrListener,d.removeAttrListener=e.removeAttrListener);d.hasOwnProperty("children")&&void 0===d.addChildAttrListener&&void 0===d.kb_childAttrListeners&&(d.kb_childAttrListeners=function(){void 0===this._kb_childAttrListeners&&
(this._kb_childAttrListeners={});return this._kb_childAttrListeners},d.addChildAttrListener=u,d.getchildAttrListeners=function(){return this.kb_childAttrListeners()});void 0===d.addAttrUpdateListener&&void 0===d.kb_attrUpdateListeners&&(d.kb_attrUpdateListeners=function(){void 0===this._kb_attrUpdateListeners&&(this._kb_attrUpdateListeners={});return this._kb_attrUpdateListeners},d.addAttrUpdateListener=e.addAttrUpdateListener,d.removeAttrUpdateListener=e.removeAttrUpdateListener);d.hasOwnProperty("children")&&
void 0===d.addChildAttrUpdateListener&&void 0===d.kb_childAttrUpdateListeners&&(d.kb_childAttrUpdateListeners=function(){void 0===this._kb_childAttrUpdateListeners&&(this._kb_childAttrUpdateListeners={});return this._kb_childAttrUpdateListeners},d.addChildAttrUpdateListener=D,d.getchildAttrUpdateListeners=function(){return this.kb_childAttrUpdateListeners()});void 0===n&&(k[c]={obj:a,proto:d,descriptors:{},set:void 0,update:void 0},n=k[c]);n.set=b?b:k[c].set;n.update=h?h:k[c].update;n.descriptors[f]=
g;void 0!==g.set&&g.configurable?Object.defineProperty(d,f,{get:g.get,set:function(a){var b=g.get.apply(this),c=n.set,d=n.update;"function"===typeof c&&c(this,f,a,b,arguments)&&g.set.apply(this,arguments);"function"===typeof d&&d(this,f,a,b,arguments)},enumerable:!0,configurable:!0}):"function"===typeof g.value?Object.defineProperty(d,f,{value:function(){var a=null,b=n.set,c=n.update;"function"===typeof b&&b(this,f,null,null,arguments)&&(a=g.value.apply(this,arguments));"function"===typeof c&&c(this,
f,null,null,arguments,a);return a},writable:!0,enumerable:!0,configurable:!0}):void 0!==g.value&&g.configurable&&Object.defineProperty(d,f,{get:function(){return g.value},set:function(a){var b=g.value,c=n.set,d=n.update;"function"===typeof c&&c(this,f,a,b)&&(g.value=a);"function"===typeof d&&d(this,f,a,b)},enumerable:!0,configurable:!0})};e.injectPrototypes=function(a,f,b){var h=a.prototype,c=a.toString().split(/\s+/)[1].split("{")[0].replace("()",""),d=k[c],m=Object.getOwnPropertyNames(h),n={},l=
function(a){var b=!1,c="false";if("checkbox"===this.type||"radio"===this.type)c=this.checked,b=!0;var e=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;setTimeout(function(){var a=d.set,f=d.update;b&&!a(this,"checked",this.checked,c)?n.checked.set.call(this,c):b&&"function"===typeof f&&f(this,"checked",this.checked,e);this.value=b?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;a(this,"value",this.value,
e)?"function"===typeof f&&f(this,"value",this.value,e):n.value.set.call(this,e)}.bind(this),0)};void 0===d&&(k[c]={obj:a,proto:h,descriptors:{},set:void 0,update:void 0},d=k[c]);d.set=f||q;d.update=b||r;-1<m.indexOf("value")&&(Object.defineProperty(h,"kb_removeInputBinding",{value:function(){this.kb_onkeydown=void 0;this.removeEventListener("keydown",l)},configurable:!0,enumerable:!0}),Object.defineProperty(h,"kb_addInputBinding",{value:function(){this.kb_onkeydown=!0;this.addEventListener("keydown",
l)},configurable:!0,enumerable:!0}),Object.defineProperty(h,"kb_removeInputBoxBinding",{value:function(){this.kb_onmousedown=void 0;this.removeEventListener("mouseup",l)},configurable:!0,enumerable:!0}),Object.defineProperty(h,"kb_addInputBoxBinding",{value:function(){this.kb_onmousedown=!0;this.addEventListener("mouseup",l)},configurable:!0,enumerable:!0}));for(g=0;g<m.length;g+=1)void 0===k[c].descriptors[m[g]]&&e.injectPrototypeProperty(a,m[g],null,null,c);return e};e.injectStyle=function(a,f,
b,g){var c=Object.getOwnPropertyDescriptor(a.style,f),d=a.style;void 0===a.style.kb_bind&&(a.style.kb_bind={obj:a,proto:d,descriptors:{},set:void 0,update:void 0},a.style.kb_bind.set=b?b:k[_injectName].set,a.style.kb_bind.update=g?g:k[_injectName].update);void 0===a.style.kb_bind.descriptors[f]&&(a.style.kb_bind.descriptors[f]=c,void 0!==c.value&&c.configurable&&Object.defineProperty(d,f,{get:function(){return c.value},set:function(b){var d=c.value;"function"==typeof a.style.kb_bind.set&&a.style.kb_bind.set(a,
f,b,d)&&(c.value=b,a.style.setProperty(f.replace(/([A-Z])/g,"-$1").replace("webkit","-webkit"),b));"function"===typeof a.style.kb_bind.update&&a.style.kb_bind.update(a,f,b,d)},enumerable:!0,configurable:!0}));return e};e.injectedPrototypes=function(){return k};e.addAttrListener=function(a,f,b){if(this.toString()!==e.toString())return"function"===typeof f&&(b?(b&&void 0===this.kb_childAttrListeners()[a]&&(this.kb_childAttrListeners()[a]=[]),this.kb_childAttrListeners()[a].push(f)):(void 0===this.kb_attrListeners()[a]&&
(this.kb_attrListeners()[a]=[]),this.kb_attrListeners()[a].push(f)),-1!==t.indexOf(a)&&(x=!0,w(a,b?this.querySelector("*"):[this]))),this;"function"===typeof f&&(void 0===l[a]&&(l[a]=[]),l[a].push(f),"*"===a||-1!==t.indexOf(a))&&(x=!0,w(a));return e};e.addAttrUpdateListener=function(a,f,b){if(this.toString()!==e.toString())return"function"===typeof f&&(b?(b&&void 0===this.kb_childAttrUpdateListeners()[a]&&(this.kb_childAttrUpdateListeners()[a]=[]),this.kb_childAttrUpdateListeners()[a].push(f)):(void 0===
this.kb_attrUpdateListeners()[a]&&(this.kb_attrUpdateListeners()[a]=[]),this.kb_attrUpdateListeners()[a].push(f)),-1!==t.indexOf(a)&&(x=!0,w(a,b?this.querySelector("*"):[this]))),this;"function"===typeof f&&(void 0===p[a]&&(p[a]=[]),p[a].push(f),"*"===a||-1!==t.indexOf(a))&&(x=!0,w(a));return e};e.getAttrListeners=function(){return this.toString()!==e.toString()?this.kb_attrListeners():l};e.getAttrUpdateListeners=function(){return this.toString()!==e.toString()?this.kb_attrUpdateListeners():p};e.removeAttrListener=
function(a,f){if(this.toString()!==e.toString()){if(void 0!==this.kb_attrListeners&&void 0!==this.kb_attrListeners()[a]&&"function"===typeof f){for(var b=0;b<this.kb_attrListeners()[a].length;b+=1)this.kb_attrListeners()[a][b].toString()===f.toString()&&this.kb_attrListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrListeners()[a])for(b=0;b<this.kb_childAttrListeners()[a].length;b+=1)this.kb_childAttrListeners()[a][b].toString()===f.toString()&&this.kb_childAttrListeners()[a].splice(b,1)}return this}if(void 0!==
l[a]&&"function"===typeof f)for(b=0;b<l[a].length;b+=1)l[a][b].toString()===f.toString()&&l[a].splice(b,1);return e};e.removeAttrUpdateListener=function(a,f){if(this.toString()!==e.toString()){if(void 0!==this.kb_attrUpdateListeners&&void 0!==this.kb_attrUpdateListeners()[a]&&"function"===typeof f){for(var b=0;b<this.kb_attrUpdateListeners()[a].length;b+=1)this.kb_attrUpdateListeners()[a][b].toString()===f.toString()&&this.kb_attrUpdateListeners()[a].splice(b,1);if(void 0!==this.kb_childAttrUpdateListeners()[a])for(b=
0;b<this.kb_childAttrUpdateListeners()[a].length;b+=1)this.kb_childAttrUpdateListeners()[a][b].toString()===f.toString()&&this.kb_childAttrUpdateListeners()[a].splice(b,1)}return this}if(void 0!==p[a]&&"function"===typeof f)for(b=0;b<p[a].length;b+=1)p[a][b].toString()===f.toString()&&p[a].splice(b,1);return e};e.injectPrototypes(Node,q,r);e.injectPrototypes(Element,q,r);e.injectPrototypes(HTMLElement,q,r);e.injectPrototypes(HTMLInputElement,q,r);e.injectPrototypes(HTMLTextAreaElement,q,r);e.injectPrototypes(Document,
q,r);return e}"function"===typeof define&&define.amd?(define("KB",u),define([],function(){return u})):"object"===typeof module&&module.exports&&(module.exports=u);return u}();

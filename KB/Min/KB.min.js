var CreateKB=function(){function n(){function d(){var a=function(){for(var b=0,a=Array.prototype.slice.call(document.getElementsByTagName("INPUT")).filter(function(b){return"radio"!==b.type&&"checkbox"!==b.type}).concat(Array.prototype.slice.call(document.getElementsByTagName("TEXTAREA"))),c=Array.prototype.slice.call(document.getElementsByTagName("INPUT")).filter(function(b){return"radio"===b.type||"checkbox"===b.type}),b=0;b<a.length;b++)void 0===a[b].kb_onkeydown&&a[b].kb_addInputBinding();for(b=
0;b<c.length;b++)void 0===c[b].kb_onmousedown&&c[b].kb_addInputBoxBinding()},c=function(b){var a=new n(b.target,b.arguments[0],"setAttribute"===b.attr?b.arguments[1]:"",b.target.getAttribute(b.arguments[0]),"setAttribute"===b.attr?[b.arguments[1]]:[""]);if(void 0!==k[a.attr])for(g=0;g<k[a.attr].length;g+=1)k[a.attr][g].call(a.target,a),a._stopPropogation&&b.stopPropagation(),a._preventDefault&&b.preventDefault()},e=function(b){var a=new n(b.target,b.arguments[0],"setAttribute"===b.attr?b.arguments[1]:
"",b.target.getAttribute(b.arguments[0]),"setAttribute"===b.attr?[b.arguments[1]]:[""]);if(void 0!==m[a.attr])for(g=0;g<m[a.attr].length;g+=1)m[a.attr][g].call(a.target,a),a._stopPropogation&&b.stopPropagation()},r=Object.keys(f);for(g=0;g<r.length;g++)void 0===f[r[g]].set&&d.injectPrototypes(f[r[g]].obj,p,q);Object.keys(f).forEach(function(a,c){});d.addAttrUpdateListener("appendChild",a);d.addAttrUpdateListener("removeChild",a);d.addAttrUpdateListener("innerHTML",a);d.addAttrUpdateListener("outerHTML",
a);d.addAttrUpdateListener("innerText",a);d.addAttrUpdateListener("outerText",a);d.addAttrUpdateListener("textContent",a);d.addAttrListener("setAttribute",c);d.addAttrListener("removeAttribute",c);d.addAttrUpdateListener("setAttribute",e);d.addAttrUpdateListener("removeAttribute",e);a()}var k={},m={},f={},g,n=function(a,c,e,d,b,f){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};this.value=e;this.oldValue=d;this.target=a;this.attr=c;
this.arguments=b;this.action=f},p=function(a,c,e,d,b){e=new n(a,c,e,d,b);d=!0;if(void 0!==k[c])for(g=0;g<k[c].length;g+=1){k[c][g].call(a,e);if(e._stopPropogation)return d;e._preventDefault&&(d=!1)}if(void 0!==a.kb_attrListeners&&void 0!==a.kb_attrListeners[c])for(g=0;g<a.kb_attrListeners[c].length;g+=1){a.kb_attrListeners[c][g].call(a,e);if(e._stopPropogation)break;e._preventDefault&&(d=!1)}return d},q=function(a,c,e,d,b,f){e=new n(a,c,e,d,b,f);d=!0;if(void 0!==m[c])for(b=0;b<m[c].length;b+=1){m[c][b].call(a,
e);if(e._stopPropogation)return d;e._preventDefault&&(d=!1)}if(void 0!==a.kb_attrUpdateListeners&&void 0!==a.kb_attrUpdateListeners[c])for(b=0;b<a.kb_attrUpdateListeners[c].length;b+=1){a.kb_attrUpdateListeners[c][b].call(a,e);if(e._stopPropogation)break;e._preventDefault&&(d=!1)}return d};d.injectPrototypeProperty=function(a,c,e,g){var b=a.prototype,l=Object.getOwnPropertyDescriptor(b,c),h=a.toString().split(/\s+/)[1].split("{")[0].replace("()","");void 0===b.addAttrListener&&void 0===b.kb_attrListeners&&
(b.kb_attrListeners={},b.addAttrListener=d.addAttrListener,b.removeAttrListener=d.removeAttrListener);void 0===b.addAttrUpdateListener&&void 0===b.kb_attrUpdateListeners&&(b.kb_attrUpdateListeners={},b.addAttrUpdateListener=d.addAttrUpdateListener,b.removeAttrUpdateListener=d.removeAttrUpdateListener);void 0===f[h]&&(f[h]={obj:a,proto:b,descriptors:{},set:void 0,update:void 0});f[h].set=void 0!==e?e:f[h].set;f[h].update=void 0!==g?g:f[h].update;f[h].descriptors[c]=l;void 0!==l.set&&l.configurable?
Object.defineProperty(b,c,{get:l.get,set:function(a){var b=l.get.apply(this);"function"==typeof f[h].set&&f[h].set(this,c,a,b,arguments)&&l.set.apply(this,arguments);"function"===typeof f[h].update&&f[h].update(this,c,a,b)},enumerable:!0,configurable:!0}):"function"===typeof l.value?Object.defineProperty(b,c,{value:function(){var a=null;"function"==typeof f[h].set&&f[h].set(this,c,null,null,arguments)&&(a=l.value.apply(this,arguments));"function"===typeof f[h].update&&f[h].update(this,c,null,null,
arguments,a);return a},writable:!0,enumerable:!0,configurable:!0}):void 0!==l.value&&l.configurable&&Object.defineProperty(b,c,{get:function(){return l.value},set:function(a){var b=l.value;"function"==typeof f[h].set&&f[h].set(this,c,a,b)&&(l.value=a);"function"===typeof f[h].update&&f[h].update(this,c,a,b)},enumerable:!0,configurable:!0})};d.injectPrototypes=function(a,c,e){var k=a.prototype,b=a.toString().split(/\s+/)[1].split("{")[0].replace("()",""),l=Object.keys(k),h={},m=function(a){var c=!1,
d="false";if("checkbox"===this.type||"radio"===this.type)d=this.checked,c=!0;var e=c?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;setTimeout(function(){c&&!f[b].set(this,"checked",this.checked,d)?h.checked.set.call(this,d):c&&"function"===typeof f[b].update&&f[b].update(this,"checked",this.checked,e);this.value=c?"string"===typeof this.checked?"true"===this.checked?"on":"off":this.checked?"on":"off":this.value;f[b].set(this,"value",this.value,
e)?"function"===typeof f[b].update&&f[b].update(this,"value",this.value,e):h.value.set.call(this,e)}.bind(this),0)};void 0===f[b]&&(f[b]={obj:a,proto:k,descriptors:{},set:void 0,update:void 0});f[b].set=c;f[b].update=e;-1<l.indexOf("value")&&(Object.defineProperty(k,"kb_removeInputBinding",{value:function(){this.kb_onkeydown=void 0;this.removeEventListener("keydown",m)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_addInputBinding",{value:function(){this.kb_onkeydown=!0;this.addEventListener("keydown",
m)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_removeInputBoxBinding",{value:function(){this.kb_onmousedown=void 0;this.removeEventListener("mouseup",m)},configurable:!0,enumerable:!0}),Object.defineProperty(k,"kb_addInputBoxBinding",{value:function(){this.kb_onmousedown=!0;this.addEventListener("mouseup",m)},configurable:!0,enumerable:!0}));for(g=0;g<l.length;g+=1)void 0===f[b].descriptors[l[g]]&&d.injectPrototypeProperty(a,l[g]);return d};d.injectedPrototypes=function(){return f};
d.addAttrListener=function(a,c){if(this.toString()!==d.toString())return void 0===this.kb_attrListeners[a]&&(this.kb_attrListeners[a]=[]),"function"===typeof c&&this.kb_attrListeners[a].push(c),this;void 0===k[a]&&(k[a]=[]);"function"===typeof c&&k[a].push(c);return d};d.addAttrUpdateListener=function(a,c){if(this.toString()!==d.toString())return void 0===this.kb_attrUpdateListeners[a]&&(this.kb_attrUpdateListeners[a]=[]),"function"===typeof c&&this.kb_attrUpdateListeners[a].push(c),this;void 0===
m[a]&&(m[a]=[]);"function"===typeof c&&m[a].push(c);return d};d.removeAttrListener=function(a,c){if(this.toString()!==d.toString()){if(void 0!==this.kb_attrListeners&&void 0!==this.kb_attrListeners[a]&&"function"===typeof c)for(var e=0;e<this.kb_attrListeners[a].length;e+=1)this.kb_attrListeners[a][e].toString()===c.toString()&&this.kb_attrListeners[a].splice(e,1);return this}if(void 0!==k[a]&&"function"===typeof c)for(e=0;e<k[a].length;e+=1)k[a][e].toString()===c.toString()&&k[a].splice(e,1);return d};
d.removeAttrUpdateListener=function(a,c){if(this.toString()!==d.toString()){if(void 0!==this.kb_attrUpdateListeners&&void 0!==this.kb_attrUpdateListeners[a]&&"function"===typeof c)for(var e=0;e<this.kb_attrUpdateListeners[a].length;e+=1)this.kb_attrUpdateListeners[a][e].toString()===c.toString()&&this.kb_attrUpdateListeners[a].splice(e,1);return this}if(void 0!==m[a]&&"function"===typeof c)for(e=0;e<m[a].length;e+=1)m[a][e].toString()===c.toString()&&m[a].splice(e,1);return d};d.injectPrototypes(HTMLInputElement,
p,q);d.injectPrototypes(HTMLTextAreaElement,p,q);d.injectPrototypes(Node,p,q);d.injectPrototypes(Element,p,q);d.injectPrototypes(HTMLElement,p,q);d.injectPrototypes(Document,p,q);return d}"function"===typeof define&&define.amd?(define("KB",n),define([],n)):"object"===typeof module&&module.exports&&(module.exports=n);return n}();
